' Gambas class file

' Description:
' FEditTVChannelsDetails.class
' Form for editing TV channel details.

' Development Status:
' Imported from Kris's own project, needs testing.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' This module is written by Kris Wauters on February, 13th - 2010
' For more info or help, mailto: kris@digitalplayground.be

' Read file called COPYING for license details.

PUBLIC SUB BtnCancel_Click()

  ME.Close

END

PUBLIC SUB BtnOK_Click()

  '--- declare variables ---
  DIM IntRecID AS Integer

  TxtEXTlogo.Text = "PNG"
  IntRecID = ScreenFunc.ActionOnDetailScreen(ME)
  IF IntRecID > 0 THEN
    ScreenFunc.BlobOnDetailScreen(IntRecID, ME.tag, PicBLOBlogo)
  END IF
  ME.Close

END

PUBLIC SUB BtnBrowse_Click()

  DIM sPath AS String

  WITH Dialog
    .Filter = ["*.png;*.jpg;*.jpeg;*.bmp;*.gif;*.xpn", ("Image files")]
    .Title = ("Please select an image ...")
    .Path = Main.sBaseDir &/ "icons/tvlogos"
  END WITH

  IF Dialog.OpenFile() THEN
    RETURN
  ELSE
    TRY PicBLOBlogo.Picture.Clear
    TRY PicBLOBlogo.Picture = Picture.Load(Dialog.path)
  END IF

END

PUBLIC SUB BtnClear_Click()

  PicBLOBlogo.Picture = NULL
  PicBLOBlogo.Refresh

END
