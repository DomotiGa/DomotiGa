' Gambas class file

' Description:
' FDebug.class
' Page for test programs, variables, buttons etc.

' Development Status:
' Just implemented, needs work.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

Private tRefresh As New Timer

Public Sub Form_Open()

  GetVarList()

  ' create refresh timer
  tRefresh = New Timer As "tRefresh"
  tRefresh.Delay = 10000 ' 10 seconds
  tRefresh.Start


End

Public Sub GetVarList()

  Dim iCount As Integer
  Dim vValue As Variant

  With tbvGlobalVar
    .Columns.Count = 2
    .Rows.Count = Main.GlobalVar.Count
    .Columns[0].Title = ("Name")
    .Columns[0].Width = 180
    .Columns[1].Title = ("Value")
    .Columns[1].Width = 150
  End With

  For Each vValue In Main.GlobalVar
    ' Get the vValue via the GetGlobalVar, else empty values are incorrectly displayed
    vValue = Main.GetGlobalVar(Main.GlobalVar.Key)
    tbvGlobalVar[iCount, 0].Text = Main.GlobalVar.Key
    If gb.Boolean = TypeOf(vValue) Then
      tbvGlobalVar[iCount, 1].Text = Main.DisplayBool(vValue)
    Else
      tbvGlobalVar[iCount, 1].Text = vValue
    End If
    iCount = iCount + 1
  Next

End

Public Sub tbvGlobalVar_ColumnClick(Column As Integer)

  FMain.SortTableView(FDebug.tbvGlobalVar, Column, True)

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' voicetext test buttons
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Public Sub btnSpeakMale_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"), "male")

End

Public Sub btnSpeakFemale_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"), "female")

End

Public Sub btnSpeakDefault_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"))

End

Public Sub btnSpeakAllison_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"), "allison")

End

Public Sub btnSpeakLinda_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"), "linda")

End

Public Sub btnSpeakEmily_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"), "emily")

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' refresh page contents
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Public Sub tRefresh_Timer()

  GetVarList()

End

Public Sub Form_Close()

  tRefresh.Stop

End

Public Sub btnSoundPlay_Click()

  Sounds.PlaySnd("click.wav")

End

Public Sub btnSoundPlay50_Click()

  Sounds.PlaySnd("click.wav", 50)

End

Public Sub btnWOL_Click()

  Main.WakeOnLan("00:19:bb:d4:ad:41")

End

Public Sub btnFanSpd1_Click()

  If Main.bServer Then
    Devices.SetDevice("House Ventilation", "1")
  Else
    XMLClient.DeviceSetDevice("House Ventilation", "1")
  End If

End

Public Sub btnFanSpd2_Click()

  If Main.bServer Then
    Devices.SetDevice("House Ventilation", "2")
  Else
    XMLClient.DeviceSetDevice("House Ventilation", "2")
  End If

End

Public Sub btnFanSpd3_Click()

  If Main.bServer Then
    Devices.SetDevice("House Ventilation", "3")
  Else
    XMLClient.DeviceSetDevice("House Ventilation", "3")
  End If

End

Public Sub btnFanTimer_Click()

  If Main.bServer Then
    Devices.SetDevice("House Ventilation", "T")
  Else
    XMLClient.DeviceSetDevice("House Ventilation", "T")
  End If

End
