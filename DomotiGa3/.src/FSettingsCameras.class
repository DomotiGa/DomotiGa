' Gambas class file

' Description:
' FSettingsCameras.class
' Settings form for all sorts of Cameras.

' Development Status:
' Just started, not 100% complete yet.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

PUBLIC iCurRow AS Integer

PUBLIC SUB Form_Open()

  ME.Move(FMain.X + 50, FMain.Y + 70)
  FillCameraDevices()

END

PUBLIC SUB FillCameraDevices()

  DIM rResult AS Result
  DIM iRows, iCount AS Integer

  rResult = Main.hDB.Exec("SELECT * FROM devices_camera")

  IF NOT rResult THEN
    Message.Info(("Error: table 'devices_camera' not found!"))
    RETURN
  ENDIF
  iRows = rResult.Count
  WITH tbvCameraDevices
    .Columns.Count = 4
    .Rows.Count = iRows
    .Columns[0].Title = ("Id")
    .Columns[0].Width = 25
    .Columns[1].Title = ("Name")
    .Columns[1].Width = 170
    .Columns[2].Title = ("Description")
    .Columns[2].Width = 250
    .Columns[3].Title = ("Type")
    .Columns[3].Width = 100
  END WITH

  FOR iCount = 0 TO rResult.Max
    tbvCameraDevices[iCount, 0].Text = rResult!id
    tbvCameraDevices[iCount, 1].Text = rResult!name
    tbvCameraDevices[iCount, 2].Text = rResult!description
    tbvCameraDevices[iCount, 3].Text = rResult!type
    rResult.MoveNext
  NEXT

END

PUBLIC SUB btnClose_Click()

  ME.Close

END

PUBLIC SUB tbvCameraDevices_DblClick()

  iCurRow = tbvCameraDevices.Row
  ' open camera device editor window
  FEditCameraDevices.Show()

END

PUBLIC SUB btnAdd_Click()

  iCurRow = -1
  ' open camera device editor window
  FEditCameraDevices.Show()

END
