' Gambas class file

' Description:
' FDSC.class
' Virtual Codepanel for DSC Security System.

' Development Status:
' Beta, needs testing.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' This module was written by Timo Sariwating in 2009.

' Read file called COPYING for license details.

PRIVATE sCode AS String

PUBLIC SUB Form_Open()

  IF NOT Main.hDSC THEN
    FDSC.LCDLine1.Text = ("DSC interface not enabled!")
  END IF

END

PUBLIC SUB btn1_Click()

  sCode &= "1"

END

PUBLIC SUB btn2_Click()

  sCode &= "2"

END

PUBLIC SUB btn3_Click()

  sCode &= "3"

END

PUBLIC SUB btn4_Click()

  sCode &= "4"

END

PUBLIC SUB btn5_Click()

  sCode &= "5"

END

PUBLIC SUB btn6_Click()

  sCode &= "6"

END

PUBLIC SUB btn7_Click()

  sCode &= "7"

END

PUBLIC SUB btn8_Click()

  sCode &= "8"

END

PUBLIC SUB btn9_Click()

  sCode &= "9"

END

PUBLIC SUB btn0_Click()

  sCode &= "0"

END

PUBLIC SUB btnStar_Click()

  sCode &= "*"

END

PUBLIC SUB btnHash_Click()

  sCode &= "#"

END

PUBLIC SUB btnEnter_Click()

  IF Main.bServer AND IF Main.hDSC THEN
    Main.hDSC.TX("0401" & sCode)
  ELSE IF Main.bDSCEnabled THEN
    XMLClient.SetAlarmPin(sCode)
  END IF
  sCode = ""

END

PUBLIC SUB btnArmStay_Click()

  IF Main.bServer AND IF Main.hDSC THEN
    Main.hDSC.TX("0311")
  ELSE IF Main.bDSCEnabled THEN
    XMLClient.SetAlarmMode("0311")
  END IF

END

PUBLIC SUB btnArmAway_Click()

  IF Main.bServer AND IF Main.hDSC THEN
    Main.hDSC.TX("0301")
  ELSE IF Main.bDSCEnabled THEN
    XMLClient.SetAlarmMode("0301")
  END IF

END
