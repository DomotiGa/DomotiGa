' Gambas class file

' Description:
' FSelectFile.class
' Provides filechooser for files.

' Development Status:
' Working.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

Private $sFile As String
'Private $sPath As String

Public Sub Run(sFile As String) As String

  $sFile = sFile
  '$sPath = sPath
  If Not Me.ShowModal() Then Return
  Return $sFile

End

Public Sub Form_Open()

  Application.Busy = True
  fchFile.Filter = ["*.xml", ("XML files")]
  fchFile.Root = "/"
  ' show preview by default, hide directory view.
  fchFile.ShowPreview = False
  fchFile.DirView.Visible = True
  fchFile.ShowBookmark = True
  fchFile.ShowDetailed = True
  If $sFile Then
    fchFile.SelectedPath = $sFile
  Endif
  Application.Busy = False

End

Public Sub btnCancel_Click()

  Me.Close

End

Public Sub btnOK_Click()

  ' return only filename part
  $sFile = fchFile.SelectedPath

  If Not $sFile Then Return
  Me.Close(True)

End

Public Sub fchFile_Activate()

  btnOK.Value = True

End

Public Sub Form_KeyPress()

  If Key.Code = Key.Enter Or Key.Code = Key.Return Then
    btnOK_Click()
  Endif
  If Key.Code = Key.Esc Then
    btnCancel_Click()
  Endif
End
