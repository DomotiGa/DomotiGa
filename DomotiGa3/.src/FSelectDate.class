' Gambas class file

' Description:
' FSelectDate.class
' Provides datechooser for birthday and other fields.

' Development Status:
' Working.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

Public sDate As String

Public Sub Run(Optional sRunDate As String) As String

  sDate = sRunDate
  If Not Me.ShowModal() Then Return
  Return sDate

End

Public Sub Form_Open()

  If sDate Then
    dchDate.Year = Year(sDate)
    dchDate.Month = Month(sDate)
    dchDate.Day = Day(sDate)
  Endif

End

Public Sub btnCancel_Click()

  Me.Close

End

Public Sub btnOK_Click()

  ' return selected date
  sDate = dchDate.Month & "/" & dchDate.Day & "/" & dchDate.Year
  Me.Close(True)

End
