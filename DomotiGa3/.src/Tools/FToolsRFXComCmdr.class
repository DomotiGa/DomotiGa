' Gambas class file

' Description:
' FToolsRFXComCmdr.class
' Allows injection of a packet to test RFXCom module parser.
' Provides functions like RFXCom's Manager.

' Development Status:
' Working

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

' transceiver / receiver / transmitter
Const recType310 As Byte = &H50
Const recType315 As Byte = &H51
Const recType43392 As Byte = &H52
Const trxType43392 As Byte = &H53
Const recType86800 As Byte = &H55
Const recType86800FSK As Byte = &H56
Const recType86830 As Byte = &H57
Const recType86830FSK As Byte = &H58
Const recType86835 As Byte = &H59
Const recType86835FSK As Byte = &H5A
Const recType86895 As Byte = &H5B

' interface commands
Const msg3undec As Byte = &H80
Const msg3RFU6 As Byte = &H40
Const msg3BYRONSX As Byte = &H20
Const msg3RSL As Byte = &H10
Const msg3LIGHTING4 As Byte = &H8
Const msg3FINEOFFSET As Byte = &H4
Const msg3RUBICSON As Byte = &H2
Const msg3AE As Byte = &H1

Const msg4BlindsT1 As Byte = &H80
Const msg4BlindsT0 As Byte = &H40
Const msg4PROGUARD As Byte = &H20
Const msg4FS20 As Byte = &H10
Const msg4LCROS As Byte = &H8
Const msg4HID As Byte = &H4
Const msg4AD As Byte = &H2
Const msg4MERTIK As Byte = &H1

Const msg5VISONIC As Byte = &H80
Const msg5ATI As Byte = &H40
Const msg5OREGON As Byte = &H20
Const msg5MEI As Byte = &H10
Const msg5HEU As Byte = &H8
Const msg5AC As Byte = &H4
Const msg5ARC As Byte = &H2
Const msg5X10 As Byte = &H1

Private $hRFXComRX As Object
Private $hRFXComTRX As Object
Private $hRFXComTX As Object

Private $TRXInstanceList As New Integer[]
Private $RXInstanceList As New Integer[]
Private $TXInstanceList As New Integer[]

Private $TRXControllerInfo As JSONCollection
Private $RXControllerInfo As JSONCollection
Private $TXControllerInfo As JSONCollection

Private $TRXError As String
Private $RXError As String
Private $TXError As String

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Code which will be executed when the form opens
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Public Sub Form_Open()

  Dim iInstance As Integer
  Dim cControllerList As JSONCollection
  Dim cData As New JSONCollection

  Me.Move(FMain.X + 50, FMain.Y + 70)

  If Main.bServer Then
    ' Check if 1 or more RFXComTRX are enabled
    If Plugin.IsPluginEnabled("RFXComTRX", 0) Then

      ' First instance. first get the list of enabled instances
      $TRXInstanceList = Plugin.GetPluginEnabledList("RFXComTRX")
    Endif

    ' Check if 1 or more RFXComRX are enabled
    If Plugin.IsPluginEnabled("RFXComRX", 0) Then

      ' First get the list of enabled instances
      $RXInstanceList = Plugin.GetPluginEnabledList("RFXComRX")
    Endif

    ' Check if 1 or more RFXComRX are enabled
    If Plugin.IsPluginEnabled("RFXComTX", 0) Then
      $TXInstanceList = Plugin.GetPluginEnabledList("RFXComTX")
    Endif
  Else
    cData.Add("list", "command")
    cControllerList = Client.Call_Tools_RFXCom_Get(cData)

    ' Don't continue if we get an empty response
    If cControllerList = Null Or If Not cControllerList.Exist("count") Then
      Message.Error(("Received an empty or invalid response from the JSON-RPC server.\nPlease consult the server logfile for more information"))
      Try Me.Close
      Return
    Endif

    ' Check if we received the valid fields and handle errors
    If cControllerList["count"] = 0 Then
      Message.Info(("RFXCom interface is not enabled"))
      Try Me.Close
      Return
    Endif

    If Not cControllerList.Exist("instance_id") Then
      Message.Error(("Missing controller list in response from the JSON-RPC server.\nPlease consult the server logfile for more information"))
      Try Me.Close
      Return
    Endif

    If TypeOf(cControllerList["instance_id"]) <> gb.Object Then
      Message.Error(("Controller list is invalid in response from the JSON-RPC server.\nPlease consult the server logfile for more information"))
      Try Me.Close
      Return
    Endif

    ' Copy the instance list to an internal variable
    $TRXInstanceList = cControllerList["instance_id"]["rfxcomtrx"]
    $RXInstanceList = cControllerList["instance_id"]["rfxcomrx"]
    $TXInstanceList = cControllerList["instance_id"]["rfxcomtx"]
  Endif

  ' loop through the list and fill the combo list
  If $TRXInstanceList.Count >= 1 Then
    cmbTRXList.Clear()
    For Each iInstance In $TRXInstanceList
      cmbTRXList.Add("instance #" & iInstance)
    Next

    ' Auto-enable the first instance
    cmbTRXList.Index = 0
  Else
    ' hide transceiver tab
    TabPanelRFXComCommander[0].Visible = False
  Endif

  If $RXInstanceList.Count >= 1 Then
    cmbRXList.Clear()
    For Each iInstance In $RXInstanceList
      cmbRXList.Add("instance #" & iInstance)
    Next

    ' Auto-enable the first instance
    cmbRXList.Index = 0
  Else
    ' hide transceiver tab
    TabPanelRFXComCommander[1].Visible = False
  Endif

  If $TXInstanceList.Count >= 1 Then
    cmbTXList.Clear()
    For Each iInstance In $TXInstanceList
      cmbTXList.Add("instance #" & iInstance)
    Next

    ' Auto-enable the first instance
    cmbTXList.Index = 0
  Else
    ' hide transceiver tab
    TabPanelRFXComCommander[2].Visible = False
  Endif

  ' fill combo's with values
  FMain.FillCombo(cmbACDevice1, "4")
  FMain.FillCombo(cmbACDevice2, "FF")
  FMain.FillCombo(cmbACDevice3, "FF")
  FMain.FillCombo(cmbACDevice4, "FF")
  FMain.FillCombo(cmbACUnit, "16")
  FMain.FillCombo(cmbARCDevice, "16")
  FMain.FillCombo(cmbLighting1Unit, "16")

  FMain.FillCombo(cmbLighting2ID2, "FF")
  FMain.FillCombo(cmbLighting2ID3, "FF")
  FMain.FillCombo(cmbLighting2ID4, "FF")
  FMain.FillCombo(cmbLighting2Unit, "16")

  FMain.FillCombo(cmbLighting5ID1, "FF")
  FMain.FillCombo(cmbLighting5ID2, "FF")
  FMain.FillCombo(cmbLighting5ID3, "FF")
  FMain.FillCombo(cmbLighting5Unit, "16")

  FMain.FillCombo(cmbCurtainUnit, "16")
  FMain.FillCombo(cmbThermostat2Unit, "1F")

  FMain.FillCombo(cmbLighting6ID1, "FF")
  FMain.FillCombo(cmbLighting6ID2, "FF")

  FMain.FillCombo(cmbChimeUnit, "FF")

  FMain.FillCombo(cmbSecurity1ID1, "FF")
  FMain.FillCombo(cmbSecurity1ID2, "FF")
  FMain.FillCombo(cmbSecurity1ID3, "FF")

  FMain.FillCombo(cmbRFYID1, "F")
  FMain.FillCombo(cmbRFYID2, "FF")
  FMain.FillCombo(cmbRFYID3, "FF")
  FMain.FillCombo(cmbRFYUnit, "F")

  FMain.FillCombo(cmbRadiator1ID1, "4")
  FMain.FillCombo(cmbRadiator1ID2, "FF")
  FMain.FillCombo(cmbRadiator1ID3, "FF")
  FMain.FillCombo(cmbRadiator1ID4, "FF")
  FMain.FillCombo(cmbRadiator1Unit, "16")
  FMain.FillCombo(cmbRadiator1Temp, "28")

  SetLighting1Commands(cmbLighting1Type.Index)
  SetLighting5Commands(cmbLighting5Type.Index)
  SetSecurity1Commands(cmbSecurity1Type.Index)
  SetFanCommands(cmbFanType.Index)

End

Private Sub SetLighting1Commands(iMode As Integer)

  Select iMode
    Case 0 ' X10
      btnLighting1AllOn.Enabled = True
      btnLighting1AllOff.Enabled = True
      btnLighting1Chime.Enabled = False
    Case 1 ' ARC
      btnLighting1AllOn.Enabled = True
      btnLighting1AllOff.Enabled = True
      btnLighting1Chime.Enabled = True
    Case 2, 3, 4, 5, 6, 9 ' ELRO AB400, EMW200, Waveman, Impuls, COCO
      btnLighting1AllOn.Enabled = False
      btnLighting1AllOff.Enabled = False
      btnLighting1Chime.Enabled = False
    Case 7, 8 ' Philips SBC, Energenie
      btnLighting1Chime.Enabled = False
      btnLighting1AllOn.Enabled = True
      btnLighting1AllOff.Enabled = True
  End Select

End

Private Sub SetLighting5Disabled()

  btnLighting5Off.Enabled = False
  btnLighting5On.Enabled = False
  btnLighting5GroupOff.Enabled = False
  btnLighting5GroupOn.Enabled = False
  btnLighting5Mood1.Enabled = False
  btnLighting5Mood2.Enabled = False
  btnLighting5Mood3.Enabled = False
  btnLighting5Mood4.Enabled = False
  btnLighting5Mood5.Enabled = False
  btnLighting5Unlock.Enabled = False
  btnLighting5Lock.Enabled = False
  btnLighting5AllLock.Enabled = False
  btnLighting5Close.Enabled = False
  btnLighting5Stop.Enabled = False
  btnLighting5Open.Enabled = False
  btnLighting5ColourPal.Enabled = False
  btnLighting5ColourTone.Enabled = False
  btnLighting5ColourCycle.Enabled = False
  btnLighting5Learn.Enabled = False
  btnLighting5Set.Enabled = False
  slLighting5Level.Enabled = False
  btnLighting5Power.Enabled = False
  btnLighting5Light.Enabled = False
  btnLighting5Bright.Enabled = False
  btnLighting5Dim.Enabled = False
  btnLighting5100.Enabled = False
  btnLighting550.Enabled = False
  btnLighting525.Enabled = False
  btnLighting5ModePlus.Enabled = False
  btnLighting5SpeedPlus.Enabled = False
  btnLighting5SpeedMin.Enabled = False
  btnLighting5ModeMin.Enabled = False
  btnLighting5ToggleG1.Enabled = False
  btnLighting5ToggleG2.Enabled = False
  btnLighting5ToggleG3.Enabled = False
  btnLighting5DimPlus.Enabled = False
  btnLighting5DimMin.Enabled = False
  btnLighting5ColorPlus.Enabled = False
  btnLighting5ColorMin.Enabled = False

End

Private Sub SetLighting5Commands(iMode As Integer)

  SetLighting5Disabled()
  Select iMode
    Case 0 ' LightwaveRF
      cmbLighting5ID1.Enabled = True
      cmbLighting5Unit.Enabled = True
      FMain.FillCombo(cmbLighting5ID1, "FF")
      FMain.FillCombo(cmbLighting5ID2, "FF")
      FMain.FillCombo(cmbLighting5Unit, "16")
      btnLighting5Off.Enabled = True
      btnLighting5On.Enabled = True
      btnLighting5GroupOff.Enabled = True
      btnLighting5Mood1.Enabled = True
      btnLighting5Mood2.Enabled = True
      btnLighting5Mood3.Enabled = True
      btnLighting5Mood4.Enabled = True
      btnLighting5Mood5.Enabled = True
      btnLighting5Unlock.Enabled = True
      btnLighting5Lock.Enabled = True
      btnLighting5AllLock.Enabled = True
      btnLighting5Close.Enabled = True
      btnLighting5Stop.Enabled = True
      btnLighting5Open.Enabled = True
      btnLighting5ColourPal.Enabled = True
      btnLighting5ColourTone.Enabled = True
      btnLighting5ColourCycle.Enabled = True
      slLighting5Level.Enabled = True
      btnLighting5Set.Enabled = True
    Case 1, 4 ' BBSB, RSL
      cmbLighting5ID1.Enabled = True
      cmbLighting5Unit.Enabled = True
      FMain.FillCombo(cmbLighting5ID1, "7")
      FMain.FillCombo(cmbLighting5ID2, "FF")
      btnLighting5Off.Enabled = True
      btnLighting5On.Enabled = True
      btnLighting5GroupOff.Enabled = True
      btnLighting5GroupOn.Enabled = False
    Case 2 ' EWM100
      cmbLighting5ID1.Index = 0
      cmbLighting5Unit.Enabled = True
      FMain.FillCombo(cmbLighting5ID2, "3F")
      btnLighting5Off.Enabled = True
      btnLighting5On.Enabled = True
      btnLighting5Learn.Enabled = True
    Case 3 ' MDREMOTE
      cmbLighting5ID1.Index = 0
      FMain.FillCombo(cmbLighting5ID1, "FF")
      FMain.FillCombo(cmbLighting5ID2, "FF")
      btnLighting5Power.Enabled = True
      btnLighting5Light.Enabled = True
      btnLighting5Bright.Enabled = True
      btnLighting5Dim.Enabled = True
      btnLighting5100.Enabled = True
      btnLighting550.Enabled = True
      btnLighting525.Enabled = True
      btnLighting5ModePlus.Enabled = True
      btnLighting5SpeedPlus.Enabled = True
      btnLighting5SpeedMin.Enabled = True
      btnLighting5ModeMin.Enabled = True
    Case 5 ' LIVOLO
      cmbLighting5ID1.Index = 0
      FMain.FillCombo(cmbLighting5ID1, "FF")
      FMain.FillCombo(cmbLighting5ID2, "FF")
      btnLighting5GroupOff.Enabled = True
      btnLighting5ToggleG1.Enabled = True
      btnLighting5ToggleG2.Enabled = True
      btnLighting5ToggleG3.Enabled = True
      btnLighting5DimPlus.Enabled = True
      btnLighting5DimMin.Enabled = True
    Case 6 ' RGBTRC01
      cmbLighting5ID1.Enabled = True
      FMain.FillCombo(cmbLighting5ID1, "FF")
      FMain.FillCombo(cmbLighting5ID2, "FF")
      btnLighting5Off.Enabled = True
      btnLighting5On.Enabled = True
      btnLighting5ColorPlus.Enabled = True
      btnLighting5ColorMin.Enabled = True
      slLighting5Level.MinValue = 6
      slLighting5Level.MaxValue = &H84
      slLighting5Level.Enabled = True
      btnLighting5Set.Enabled = True
      btnLighting5Dim.Enabled = True
      btnLighting5Bright.Enabled = True
  End Select

End

Private Sub SetFanCommands(iMode As Integer)

  Select iMode
    Case 0 ' Siemens SF01
      cmbFanID1.Enabled = False
      cmbFanID2.Enabled = True
      cmbFanID3.Enabled = True
      FMain.FillCombo(cmbFanID1, "FF")
      FMain.FillCombo(cmbFanID2, "7F")
      FMain.FillCombo(cmbFanID3, "FF")

  End Select

End

Private Sub SetSecurity1Disabled()

  btnSecurity1Panic.Enabled = False
  btnSecurity1EndPanic.Enabled = False
  btnSecurity1ArmAway.Enabled = False
  btnSecurity1ArmAwayDelay.Enabled = False
  btnSecurity1ArmHome.Enabled = False
  btnSecurity1ArmHomeDelay.Enabled = False
  btnSecurity1Disarm.Enabled = False
  btnSecurity1Light1Off.Enabled = False
  btnSecurity1Light1On.Enabled = False
  btnSecurity1Light2Off.Enabled = False
  btnSecurity1Light2On.Enabled = False
  btnSecurity1Pair.Enabled = False
  btnSecurity1Normal.Enabled = False
  btnSecurity1Alarm.Enabled = False
  btnSecurity1NormalTamper.Enabled = False
  btnSecurity1AlarmTamper.Enabled = False
  btnSecurity1NormalDelay.Enabled = False
  btnSecurity1AlarmDelay.Enabled = False
  btnSecurity1NormalDelayTamper.Enabled = False
  btnSecurity1AlarmDelayTamper.Enabled = False
  btnSecurity1MotionTamper.Enabled = False
  btnSecurity1NoMotionTamper.Enabled = False
  btnSecurity1IRbeam.Enabled = False
  btnSecurity1Motion.Enabled = False
  btnSecurity1NoMotion.Enabled = False

End

Private Sub SetSecurity1Commands(iMode As Integer)

  SetSecurity1Disabled()
  Select iMode
    Case 0 ' X10SecDW
      cmbSecurity1ID2.Index = cmbSecurity1ID1.Index Xor &HF
      cmbSecurity1ID2.Enabled = False
      cmbSecurity1ID3.Enabled = True
      btnSecurity1Normal.Enabled = True
      btnSecurity1NormalDelay.Enabled = True
      btnSecurity1Alarm.Enabled = True
      btnSecurity1AlarmDelay.Enabled = True
      btnSecurity1NormalTamper.Enabled = True
      btnSecurity1NormalDelayTamper.Enabled = True
      btnSecurity1AlarmTamper.Enabled = True
      btnSecurity1AlarmDelayTamper.Enabled = True

    Case 1 ' X10SecMotion
      cmbSecurity1ID2.Index = cmbSecurity1ID1.Index Xor &HF
      cmbSecurity1ID2.Enabled = False
      cmbSecurity1ID3.Enabled = True
      btnSecurity1Motion.Enabled = True
      btnSecurity1NoMotion.Enabled = True
      btnSecurity1MotionTamper.Enabled = True
      btnSecurity1NoMotionTamper.Enabled = True

    Case 2 ' X10SecRemote
      cmbSecurity1ID2.Index = cmbSecurity1ID1.Index Xor &HF
      cmbSecurity1ID2.Enabled = False
      cmbSecurity1ID3.Enabled = True
      btnSecurity1Panic.Enabled = True
      btnSecurity1EndPanic.Enabled = True
      btnSecurity1ArmAway.Enabled = True
      btnSecurity1ArmAwayDelay.Enabled = True
      btnSecurity1ArmHome.Enabled = True
      btnSecurity1ArmHomeDelay.Enabled = True
      btnSecurity1Disarm.Enabled = True
      btnSecurity1Light1Off.Enabled = True
      btnSecurity1Light1On.Enabled = True
      btnSecurity1Light2Off.Enabled = True
      btnSecurity1Light2On.Enabled = True

    Case 3, 4 ' KD101 Smoke,SA30 Smoke
      cmbSecurity1ID2.Index = 0
      cmbSecurity1ID2.Enabled = True
      cmbSecurity1ID3.Enabled = False
      btnSecurity1Panic.Enabled = True
      btnSecurity1Pair.Enabled = True

    Case 5 ' PowerCodeDW
      cmbSecurity1ID2.Enabled = True
      cmbSecurity1ID3.Enabled = True
      btnSecurity1Normal.Enabled = True
      btnSecurity1Alarm.Enabled = True
      btnSecurity1MotionTamper.Enabled = True
      btnSecurity1NoMotionTamper.Enabled = True

    Case 6 ' PowerCodeMotion
      cmbSecurity1ID2.Enabled = True
      cmbSecurity1ID3.Enabled = True
      btnSecurity1Motion.Enabled = True
      btnSecurity1NoMotion.Enabled = True
      btnSecurity1MotionTamper.Enabled = True
      btnSecurity1NoMotionTamper.Enabled = True

    Case 7 ' PowerCodeAux
      cmbSecurity1ID2.Enabled = True
      cmbSecurity1ID3.Enabled = True
      btnSecurity1Normal.Enabled = True
      btnSecurity1Alarm.Enabled = True
      btnSecurity1MotionTamper.Enabled = True
      btnSecurity1NoMotionTamper.Enabled = True

    Case 8 ' Meiantech, Atlantic, Aidebao
      cmbSecurity1ID2.Enabled = True
      cmbSecurity1ID3.Enabled = True
      btnSecurity1Panic.Enabled = True
      btnSecurity1IRbeam.Enabled = True
      btnSecurity1ArmAway.Enabled = True
      btnSecurity1ArmHome.Enabled = True
      btnSecurity1Disarm.Enabled = True
  End Select

End

Public Sub btnClose_Click()

  Me.Close

End

Public Sub btnInject_Click()

  Dim cData As New Collection

  If Main.bServer Then
    If txtPacketRX.Text Then
      $hRFXComRX.bSimulate = True
      $hRFXComRX.Simulate(txtPacketRX.Text)
    Endif
  Else
    If txtPacketRX.Text Then
      cData["rfxcom"] = "rfxcomrx"
      cData["instance_id"] = $RXInstanceList[cmbRXList.Index]
      cData["function"] = "simulate"
      cData["command"] = txtPacketRX.Text
      Client.Call_Tools_RFXCom_Set(cData)
    Endif
  Endif

End

Public Sub btnVersion_Click()

  Dim cData As New Collection

  If Main.bServer Then
    $hRFXComRX.GetVersion()
  Else
    cData["rfxcom"] = "rfxcomrx"
    cData["instance_id"] = $RXInstanceList[cmbRXList.Index]
    cData["function"] = "getversion"
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Private Sub Command_ProtocolSetupRX(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    Select sCommand
      Case "enableall"
        $hRFXComRX.ProtocolSetup("ALL")
      Case "disableoregon"
        $hRFXComRX.ProtocolSetup("OREGON")
      Case "disablex10"
        $hRFXComRX.ProtocolSetup("X10")
      Case "disablearc"
        $hRFXComRX.ProtocolSetup("ARC")
      Case "disablekoppla"
        $hRFXComRX.ProtocolSetup("KOPPLA")
      Case "disableati"
        $hRFXComRX.ProtocolSetup("ATI")
      Case "disablevisonic"
        $hRFXComRX.ProtocolSetup("VISONIC")
      Case "disablesomfy"
        $hRFXComRX.ProtocolSetup("SOMFY")
      Case "disableheuk"
        $hRFXComRX.ProtocolSetup("HEUK")
      Case "disableheeu"
        $hRFXComRX.ProtocolSetup("HEEU")
    End Select
  Else
    cData["rfxcom"] = "rfxcomrx"
    cData["instance_id"] = $RXInstanceList[cmbRXList.Index]
    cData["function"] = "protocolsetup"
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnEnableAll_Click()

  Command_ProtocolSetupRX("enableall")

End

Public Sub btnOregon_Click()

  Command_ProtocolSetupRX("disableoregon")

End

Public Sub btnX10_Click()

  Command_ProtocolSetupRX("disablex10")

End

Public Sub btnARC_Click()

  Command_ProtocolSetupRX("disablarc")

End

Public Sub btnKoppla_Click()

  Command_ProtocolSetupRX("disablekoppla")

End

Public Sub btnATI_Click()

  Command_ProtocolSetupRX("disableati")

End

Public Sub btnVisonic_Click()

  Command_ProtocolSetupRX("disablevisonic")

End

Public Sub btnSomfy_Click()

  Command_ProtocolSetupRX("disablesomfy")

End

Public Sub btnHEUK_Click()

  Command_ProtocolSetupRX("disableheuk")

End

Public Sub btnHEEU_Click()

  Command_ProtocolSetupRX("disableheeu")

End

Public Sub EnableDisableRX(bEnable As Boolean)

  btnSomfy.Enabled = bEnable
  btnVisonic.Enabled = bEnable
  btnATI.Enabled = bEnable
  btnKoppla.Enabled = bEnable
  btnARC.Enabled = bEnable
  btnX10.Enabled = bEnable
  btnOregon.Enabled = bEnable
  btnHEUK.Enabled = bEnable
  btnHEEU.Enabled = bEnable
  btnVersion.Enabled = bEnable
  btnEnableAll.Enabled = bEnable
  btnInject.Enabled = bEnable
  txtPacketRX.Enabled = bEnable

End

Public Sub EnableDisableTX(bEnable As Boolean)

  btnVersionTX.Enabled = bEnable
  btnEnableARCTX.Enabled = bEnable
  btnEnableHarrisonTX.Enabled = bEnable
  btnDisableX10TX.Enabled = bEnable
  btnEnableKopplaTX.Enabled = bEnable
  slDim.Enabled = bEnable

  ' ARC / X10
  btnARCOn.Enabled = bEnable
  btnARCOff.Enabled = bEnable
  btnARCDim.Enabled = bEnable
  btnARCBright.Enabled = bEnable
  btnARCLightsOff.Enabled = bEnable
  btnARCLightsOn.Enabled = bEnable
  cmbARCHouse.Enabled = bEnable
  cmbARCDevice.Enabled = bEnable

  ' AC / HE UK
  cmbACDevice1.Enabled = bEnable
  cmbACDevice2.Enabled = bEnable
  cmbACDevice3.Enabled = bEnable
  cmbACDevice4.Enabled = bEnable
  cmbACUnit.Enabled = bEnable
  btnACOff.Enabled = bEnable
  btnACOn.Enabled = bEnable
  chkHEEU.Enabled = bEnable
  tbtnACGroup.Enabled = bEnable

End

' 0=Disabled, 2=Transceiver, 1=Receiver Only
Public Sub EnableDisableTRX(iType As Integer)

  btnTRXReset.Enabled = iType >= 1
  btnTRXGetStatus.Enabled = iType >= 1
  btnTRXSave.Enabled = iType >= 1
  btnTRXSetMode.Enabled = iType >= 1
  btnInjectTRX.Enabled = iType >= 1

  btnLighting1Off.Enabled = iType >= 2
  btnLighting1On.Enabled = iType >= 2
  btnLighting1AllOn.Enabled = iType >= 2
  btnLighting1AllOff.Enabled = iType >= 2
  btnLighting1Chime.Enabled = iType >= 2

  btnLighting2On.Enabled = iType >= 2
  btnLighting2Off.Enabled = iType >= 2
  btnLighting2AllOff.Enabled = iType >= 2
  btnLighting2AllOn.Enabled = iType >= 2
  slLighting2Dim.Enabled = iType >= 2

  btnLighting5On.Enabled = iType >= 2
  btnLighting5Off.Enabled = iType >= 2
  btnLighting5AllLock.Enabled = iType >= 2
  btnLighting5Close.Enabled = iType >= 2
  btnLighting5GroupOn.Enabled = iType >= 2
  btnLighting5GroupOff.Enabled = iType >= 2
  btnLighting5Lock.Enabled = iType >= 2
  btnLighting5Mood1.Enabled = iType >= 2
  btnLighting5Mood2.Enabled = iType >= 2
  btnLighting5Mood3.Enabled = iType >= 2
  btnLighting5Mood4.Enabled = iType >= 2
  btnLighting5Mood5.Enabled = iType >= 2
  btnLighting5Open.Enabled = iType >= 2
  btnLighting5Unlock.Enabled = iType >= 2
  btnLighting5Stop.Enabled = iType >= 2

  btnLighting6GroupOff.Enabled = iType >= 2
  btnLighting6GroupOn.Enabled = iType >= 2
  btnLighting6On.Enabled = iType >= 2
  btnLighting6Off.Enabled = iType >= 2

  btnCurtainClose.Enabled = iType >= 2
  btnCurtainOpen.Enabled = iType >= 2
  btnCurtainStop.Enabled = iType >= 2
  btnCurtainProgram.Enabled = iType >= 2

  btnFanTimer.Enabled = iType >= 2
  btnFanLearn.Enabled = iType >= 2
  btnFanConfirm.Enabled = iType >= 2
  btnFanPlus.Enabled = iType >= 2
  btnFanMinus.Enabled = iType >= 2
  btnFanLight.Enabled = iType >= 2

  btnThermostat2Off.Enabled = iType >= 2
  btnThermostat2On.Enabled = iType >= 2
  btnThermostat2Program.Enabled = iType >= 2

  btnChimeBigBen.Enabled = iType >= 2
  btnChimeSolo.Enabled = iType >= 2
  btnChimeTubular2.Enabled = iType >= 2
  btnChimeTubular3.Enabled = iType >= 2

  ' Disable all transceiver types
  RadioButton310MHz.Value = False
  RadioButton315Mhz.Value = False
  RadioButton43392MHz.Value = False
  RadioButton868MHz.Value = False
  RadioButton868MHzFSK.Value = False
  RadioButton86830MHz.Value = False
  RadioButton86830MHzFSK.Value = False
  RadioButton86835MHz.Value = False
  RadioButton86835MHzFSK.Value = False
  RadioButton86895MHz.Value = False

  txtTRXFirmwareVersion.Text = "UNKNOWN"
  txtTRXHardwareVersion.Text = "UNKNOWN"

  ' Disable protocols
  chkTRXAC.Enabled = False
  chkTRXAD.Enabled = False
  chkTRXAE.Enabled = False
  chkTRXARC.Enabled = False
  chkTRXATI.Enabled = False
  chkTRXBlindsT0.Enabled = False
  chkTRXBlindsT1.Enabled = False
  chkTRXFineOffset.Enabled = False
  chkTRXFS20.Enabled = False
  chkTRXHEEU.Enabled = False
  chkTRXHideki.Enabled = False
  chkTRXLaCrosse.Enabled = False
  chkTRXLighting4.Enabled = False
  chkTRXMeiantech.Enabled = False
  chkTRXMertik.Enabled = False
  chkTRXOregon.Enabled = False
  chkTRXProGuard.Enabled = False
  chkTRXRSL.Enabled = False
  chkTRXByronSX.Enabled = False
  chkTRXRFU6.Enabled = False
  chkTRXRubicson.Enabled = False
  chkTRXUndec.Enabled = False
  chkTRXVisonic.Enabled = False
  chkTRXX10.Enabled = False

End

Public Sub btnVersionTX_Click()

  Dim cData As New Collection

  If Main.bServer Then
    $hRFXComTX.GetVersion()
  Else
    cData["rfxcom"] = "rfxcomtx"
    cData["instance_id"] = $TXInstanceList[cmbTXList.Index]
    cData["function"] = "getversion"
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Private Sub Command_ProtocolSetupTX(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    Select sCommand
      Case "enablearc"
        $hRFXComTX.EnableARCTX()
      Case "enableharrison"
        $hRFXComTX.EnableHarrisonTX()
      Case "enablekoppla"
        $hRFXComTX.EnableKopplaTX()
      Case "disablex10"
        $hRFXComTX.DisableX10TX()
    End Select
  Else
    cData["rfxcom"] = "rfxcomtx"
    cData["instance_id"] = $TXInstanceList[cmbTXList.Index]
    cData["function"] = "protocolsetup"
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnEnableARCTX_Click()

  Command_ProtocolSetupTX("enablearc")

End

Public Sub btnEnableHarrisonTX_Click()

  Command_ProtocolSetupTX("enableharrison")

End

Public Sub btnEnableKopplaTX_Click()

  Command_ProtocolSetupTX("enablekoppla")

End

Public Sub btnDisableX10TX_Click()

  Command_ProtocolSetupTX("disablex10")

End

Public Sub ControlTX(sAddress As String, sCommand As String)

  Dim cData As New Collection

  If Main.bServer Then
    $hRFXComTX.X10(sAddress, sCommand)
  Else
    cData["rfxcom"] = "rfxcomtx"
    cData["instance_id"] = $TXInstanceList[cmbTXList.Index]
    cData["function"] = "x10"
    cData["address"] = sAddress
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

' ARC
Public Sub btnARCOn_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "On")

End

Public Sub btnARCOff_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "Off")

End

Public Sub btnARCDim_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "Dim")

End

Public Sub btnARCBright_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "Bright")

End

Public Sub btnARCLightsOn_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "All_Lights_On")

End

Public Sub btnARCLightsOff_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "All_Lights_Off")

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' AC command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_ACTX(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTX.AC("0x" & cmbACDevice1.Index & cmbACDevice2.Text & cmbACDevice3.Text & cmbACDevice4.Text & " " & cmbACUnit.Text, sCommand, chkHEEU.Value, tbtnACGroup.Value)
  Else
    cData["rfxcom"] = "rfxcomtx"
    cData["instance_id"] = $TXInstanceList[cmbTXList.Index]
    cData["function"] = "ac"
    cData["address"] = "0x" & cmbACDevice1.Index & cmbACDevice2.Text & cmbACDevice3.Text & cmbACDevice4.Text & " " & cmbACUnit.Text
    cData["command"] = sCommand
    cData["heeu"] = CBool(chkHEEU.Value)
    cData["group"] = CBool(tbtnACGroup.Value)
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

' AC / HEEU
Public Sub btnACOn_Click()

  Command_ACTX("On")

End

Public Sub btnACOff_Click()

  Command_ACTX("Off")

End

Public Sub slDim_Change()

  Command_ACTX("Dim " & slDim.Value)

End

Public Sub cmbLighting1Type_Click()

  SetLighting1Commands(cmbLighting1Type.Index)

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Lighting1 command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Lighting1(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Lighting1(cmbLighting1Type.Text, cmbLighting1House.Text & Format(cmbLighting1Unit.Text, "00"), sCommand, chkLighting1Group.Value)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "lighting1"
    cData["type"] = cmbLighting1Type.Text
    cData["address"] = cmbLighting1House.Text & Format(cmbLighting1Unit.Text, "00")
    cData["command"] = sCommand
    cData["group"] = CBool(chkLighting1Group.Value)
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

' TRX lighting1
Public Sub btnLighting1On_Click()

  Command_Lighting1("ON")

End

Public Sub btnLighting1Off_Click()

  Command_Lighting1("OFF")

End

Public Sub btnLighting1Chime_Click()

  Command_Lighting1("CHIME")

End

Public Sub btnLighting1AllOn_Click()

  Command_Lighting1("ALL ON")

End

Public Sub btnLighting1AllOff_Click()

  Command_Lighting1("ALL OFF")

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Lighting2 command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Lighting2(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Lighting2(cmbLighting2Type.Text, "0x" & cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text, sCommand, chkLighting2Group.Value)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "lighting2"
    cData["type"] = cmbLighting2Type.Text
    cData["address"] = "0x" & cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text
    cData["command"] = sCommand
    cData["group"] = CBool(chkLighting2Group.Value)
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnLighting2On_Click()

  Command_Lighting2("ON")

End

Public Sub btnLighting2Off_Click()

  Command_Lighting2("OFF")

End

Public Sub btnLighting2AllOn_Click()

  Command_Lighting2("ALL ON")

End

Public Sub btnLighting2AllOff_Click()

  Command_Lighting2("ALL OFF")

End

Public Sub slLighting2Dim_Change()

  Command_Lighting2("DIM " & slLighting2Dim.Value)

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Lighting5 command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Lighting5(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Lighting5(cmbLighting5Type.Text, "0x" & cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, sCommand)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "lighting5"
    cData["type"] = cmbLighting5Type.Text
    cData["address"] = "0x" & cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnLighting5On_Click()

  Command_Lighting5("ON")

End

Public Sub btnLighting5Off_Click()

  Command_Lighting5("OFF")

End

Public Sub btnLighting5GrpOff_Click()

  Command_Lighting5("GROUP OFF")

End

Public Sub btnLighting5GrpOn_Click()

  Command_Lighting5("GROUP ON")

End

Public Sub btnLighting5Mood1_Click()

  Command_Lighting5("MOOD1")

End

Public Sub btnLighting5Mood2_Click()

  Command_Lighting5("MOOD2")

End

Public Sub btnLighting5Mood3_Click()

  Command_Lighting5("MOOD3")

End

Public Sub btnLighting5Mood4_Click()

  Command_Lighting5("MOOD4")

End

Public Sub btnLighting5Mood5_Click()

  Command_Lighting5("MOOD5")

End

Public Sub btnLighting5Close_Click()

  Command_Lighting5("CLOSE")

End

Public Sub btnLighting5Stop_Click()

  Command_Lighting5("STOP")

End

Public Sub btnLighting5Open_Click()

  Command_Lighting5("OPEN")

End

Public Sub btnLighting5Unlock_Click()

  Command_Lighting5("UNLOCK")

End

Public Sub btnLighting5Lock_Click()

  Command_Lighting5("LOCK")

End

Public Sub btnLighting5AllLock_Click()

  Command_Lighting5("ALL LOCK")

End

Public Sub btnLighting5ColorPlus_Click()

  Command_Lighting5("COLOR+")

End

Public Sub btnLighting5ColorMin_Click()

  Command_Lighting5("COLOR-")

End

Public Sub btnLighting5Learn_Click()

  Command_Lighting5("LEARN")

End

Public Sub btnLighting5DimPlus_Click()

  Command_Lighting5("DIM+")

End

Public Sub btnLighting5DimMin_Click()

  Command_Lighting5("DIM-")

End

Public Sub btnLighting5Power_Click()

  Command_Lighting5("POWER")

End

Public Sub btnLighting5Light_Click()

  Command_Lighting5("LIGHT")

End

Public Sub btnLighting5Bright_Click()

  Command_Lighting5("BRIGHT")

End

Public Sub btnLighting5Dim_Click()

  Command_Lighting5("DIM")

End

Public Sub btnLighting5ModePlus_Click()

  Command_Lighting5("MODE+")

End

Public Sub btnLighting5ModeMin_Click()

  Command_Lighting5("MODE-")

End

Public Sub btnLighting5SpeedPlus_Click()

  Command_Lighting5("SPEED+")

End

Public Sub btnLighting5SpeedMin_Click()

  Command_Lighting5("SPEED-")

End

Public Sub btnLighting5100_Click()

  Command_Lighting5("100%")

End

Public Sub btnLighting550_Click()

  Command_Lighting5("50%")

End

Public Sub btnLighting525_Click()

  Command_Lighting5("25%")

End

Public Sub btnLighting5ColourCycle_Click()

  Command_Lighting5("COLOURCYCLE " & slLighting5Level.Value)

End

Public Sub btnLighting5ColourTone_Click()

  Command_Lighting5("COLOURTONE " & slLighting5Level.Value)

End

Public Sub btnLighting5ColourPal_Click()

  Command_Lighting5("COLOURPALETTE " & slLighting5Level.Value)

End

Public Sub btnLighting5Set_Click()

  Select Case cmbLighting5Type.Index
    Case 0 ' LightwaveRF
      Command_Lighting5("DIM " & slLighting5Level.Value)
    Case 6 ' RGBTRC01
      Command_Lighting5("COLOR " & slLighting5Level.Value)
  End Select

End

Public Sub btnLighting5GroupOff_Click()

  Command_Lighting5("GROUP OFF")

End

Public Sub btnLighting5ToggleG1_Click()

  Command_Lighting5("ON")

End

Public Sub btnLighting5ToggleG2_Click()

  Command_Lighting5("ON2")

End

Public Sub btnLighting5ToggleG3_Click()

  Command_Lighting5("ON3")

End

Public Sub cmbLighting5Type_Click()

  SetLighting5Commands(cmbLighting5Type.Index)

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Lighting6 command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Lighting6(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Lighting6(cmbLighting6Type.Text, "0x" & cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text, sCommand)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "lighting6"
    cData["type"] = cmbLighting6Type.Text
    cData["address"] = "0x" & cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnLighting6On_Click()

  Command_Lighting6("ON")

End

Public Sub btnLighting6Off_Click()

  Command_Lighting6("OFF")

End

Public Sub btnLighting6GroupOff_Click()

  Command_Lighting6("GROUP OFF")

End

Public Sub btnLighting6GroupOn_Click()

  Command_Lighting6("GROUP ON")

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Chime command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Chime(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Chime(cmbChimeType.Text, Format(cmbChimeUnit.Text, "00"), sCommand)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "chime"
    cData["type"] = cmbChimeType.Text
    cData["address"] = Format(cmbChimeUnit.Text, "00")
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

' TRX Chime
Public Sub btnChimeBigBen_Click()

  Command_Chime("BigBen")

End

Public Sub btnChimeSolo_Click()

  Command_Chime("Solo")

End

Public Sub btnChimeTubular2_Click()

  Command_Chime("Tubular2")

End

Public Sub btnChimeTubular3_Click()

  Command_Chime("Tubular3")

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' ProtocolSetup command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_ProtocolSetupTRX(sCommand As String, Optional aMode As Byte[])

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.ProtocolSetup(sCommand, aMode)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "protocolsetup"
    cData["command"] = sCommand
    cData["mode"] = aMode
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnTRXSave_Click()

  Command_ProtocolSetupTRX("SAVE")

End

Public Sub btnTRXReset_Click()

  Command_ProtocolSetupTRX("RESET")

End

Public Sub btnTRXGetStatus_Click()

  Command_ProtocolSetupTRX("STATUS")

End

Public Sub btnTRXSetMode_Click()

  Dim aMsg As New Byte[4]

  aMsg[0] = &H53

  If chkTRXUndec.Value Then
    aMsg[1] = &H80
  Else
    aMsg[1] = 0
  Endif

  If chkTRXBlindsT0.Value Then
    ' All other protocol receiving is disabled if BlindsT0 enabled
    ' BlindsT0 receive is only used to read the address code of the remote
    aMsg[2] = aMsg[2] Or msg4BlindsT0
    aMsg[3] = 0
  Else
    ' msg3
    If chkTRXRFU6.Value Then
      aMsg[1] = aMsg[1] Or msg3RFU6
    Endif
    If chkTRXByronSX.Value Then
      aMsg[1] = aMsg[1] Or msg3BYRONSX
    Endif
    If chkTRXRSL.Value Then
      aMsg[1] = aMsg[1] Or msg3RSL
    Endif
    If chkTRXLighting4.Value Then
      aMsg[1] = aMsg[1] Or msg3LIGHTING4
    Endif
    If chkTRXFineOffset.Value Then
      aMsg[1] = aMsg[1] Or msg3FINEOFFSET
    Endif
    If chkTRXRubicson.Value Then
      aMsg[1] = aMsg[1] Or msg3RUBICSON
    Endif
    If chkTRXAE.Value Then
      aMsg[1] = aMsg[1] Or msg3AE
    Endif

    ' msg4
    If chkTRXBlindsT1.Value Then
      aMsg[2] = aMsg[2] Or msg4BlindsT1
    Endif
    If chkTRXProGuard.Value Then
      aMsg[2] = aMsg[2] Or msg4PROGUARD
    Endif
    If chkTRXFS20.Value Then
      aMsg[2] = aMsg[2] Or msg4FS20
    Endif
    If chkTRXLaCrosse.Value Then
      aMsg[2] = aMsg[2] Or msg4LCROS
    Endif
    If chkTRXHideki.Value Then
      aMsg[2] = aMsg[2] Or msg4HID
    Endif
    If chkTRXAD.Value Then
      aMsg[2] = aMsg[2] Or msg4AD
    Endif
    If chkTRXMertik.Value Then
      aMsg[2] = aMsg[2] Or msg4MERTIK
    Endif

    ' msg5
    If chkTRXVisonic.Value Then
      aMsg[3] = aMsg[3] Or msg5VISONIC
    Endif
    If chkTRXATI.Value Then
      aMsg[3] = aMsg[3] Or msg5ATI
    Endif
    If chkTRXOregon.Value Then
      aMsg[3] = aMsg[3] Or msg5Oregon
    Endif
    If chkTRXMeiantech.Value Then
      aMsg[3] = aMsg[3] Or msg5MEI
    Endif
    If chkTRXHEEU.Value Then
      aMsg[3] = aMsg[3] Or msg5HEU
    Endif
    If chkTRXAC.Value Then
      aMsg[3] = aMsg[3] Or msg5AC
    Endif
    If chkTRXARC.Value Then
      aMsg[3] = aMsg[3] Or msg5ARC
    Endif
    If chkTRXX10.Value Then
      aMsg[3] = aMsg[3] Or msg5X10
    Endif
  Endif

  Command_ProtocolSetupTRX("SETMODE", aMsg)

End

Public Sub btnInjectTRX_Click()

  $hRFXComTRX.Simulate(txtPacketTRX.Text)

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Curtain command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Curtain(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Curtain(cmbCurtainType.Text, cmbCurtainHouse.Text & Format(cmbCurtainUnit.Text, "00"), sCommand)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "curtain"
    cData["type"] = cmbCurtainType.Text
    cData["address"] = cmbCurtainHouse.Text & Format(cmbCurtainUnit.Text, "00")
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnCurtainOpen_Click()

  Command_Curtain("OPEN")

End

Public Sub btnCurtainClose_Click()

  Command_Curtain("CLOSE")

End

Public Sub btnCurtainStop_Click()

  Command_Curtain("STOP")

End

Public Sub btnCurtainProgram_Click()

  Command_Curtain("PROGRAM")

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Thermostat2 command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Thermostat2(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Thermostat2(cmbThermostat2Type.Text, cmbThermostat2Unit.Text, sCommand)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "thermostat2"
    cData["type"] = cmbThermostat2Type.Text
    cData["address"] = cmbThermostat2Unit.Text
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnThermostat2On_Click()

  Command_Thermostat2("ON")

End

Public Sub btnThermostat2Off_Click()

  Command_Thermostat2("OFF")

End

Public Sub btnThermostat2Program_Click()

  Command_Thermostat2("PROGRAM")

End

Public Sub cmbTRXList_Click()

  Dim bIsRunning As Boolean
  Dim cData As New JSONCollection

  ' Reset to blank, we use this variable to detect if an internal error happened
  $TRXError = ""

  If Main.bServer Then
    Try $hRFXComTRX = Plugin.GetPluginObject("RFXComTRX", $TRXInstanceList[cmbTRXList.Index]).Interface
    If Error Then
      $TRXError = "RFXComTRX Object Instance '" & $TRXInstanceList[cmbTRXList.Index] & "' doesn't exist\nPlease report this as a bug"
    Else
      cData = New JSONCollection
      cData.Add("controller", "command")
      cData.Add("rfxcomtrx", "rfxcom")
      $TRXControllerInfo = $hRFXComTRX.JsonRpc_Tools_RFXCom_Get(cData)
      If $TRXControllerInfo = Null Then
        $TRXError = "RFXComTRX Object Instance '" & $TRXInstanceList[cmbTRXList.Index] & "' reported an empty controller info.\nPlease report this as a bug"
      Else
        If Not $TRXControllerInfo.Exist("instance_id") Then
          $TRXError = "RFXComTRX Object Instance '" & $TRXInstanceList[cmbTRXList.Index] & "' doesn't have an instance id.\nPlease report this as a bug"
        Endif
      Endif
    Endif
  Else
    cData = New JSONCollection
    cData.Add("controller", "command")
    cData.Add("rfxcomtrx", "rfxcom")
    cData.Add($TRXInstanceList[cmbTRXList.Index], "instance_id")
    $TRXControllerInfo = Client.Call_Tools_RFXCom_Get(cData)

    ' Report an invalid JSON-RPC response - this shouldn't happen at this stage
    If $TRXControllerInfo = Null Or If Not $TRXControllerInfo.Exist("instance_id") Then
      $TRXError = "Received an empty or invalid response from the JSON-RPC server.\nPlease consult the server logfile for more information"
    Endif
  Endif

  If $TRXError Then
    txtTRXStatus.Text = ("Not Connected")
    txtTRXStatus.Foreground = &HFF0000
    btnTRXShowError.Visible = True
    EnableDisableTRX(0)

    Message.Error($TRXError)
  Else

    Try bIsRunning = $TRXControllerInfo["running"]

    If bIsRunning Then
      txtTRXStatus.Text = ("Connected")
      txtTRXStatus.Foreground = &H00FF00
      btnTRXShowError.Visible = False
      $TRXError = ""

      ' set the type in the main
      Select $TRXControllerInfo["receivertype"]
        Case recType310
          EnableDisableTRX(1)
          RadioButton310MHz.Value = True
          chkTRXX10.Enabled = True
        Case recType315
          EnableDisableTRX(1)
          RadioButton315Mhz.Value = True
          chkTRXVisonic.Enabled = True
        Case recType43392, trxType43392
          If $TRXControllerInfo["receivertype"] = recType43392 Then
            EnableDisableTRX(1)
          Else
            EnableDisableTRX(2)
          Endif

          RadioButton43392MHz.Value = True
          chkTRXAC.Enabled = True
          chkTRXAD.Enabled = True
          chkTRXAE.Enabled = True
          chkTRXARC.Enabled = True
          chkTRXATI.Enabled = True
          chkTRXBlindsT0.Enabled = True
          chkTRXBlindsT1.Enabled = True
          chkTRXFineOffset.Enabled = True
          chkTRXHEEU.Enabled = True
          chkTRXHideki.Enabled = True
          chkTRXLaCrosse.Enabled = True
          chkTRXLighting4.Enabled = True
          chkTRXMeiantech.Enabled = True
          chkTRXMertik.Enabled = True
          chkTRXOregon.Enabled = True
          chkTRXRSL.Enabled = True
          chkTRXByronSX.Enabled = True
          'chkTRXRFU6.Enabled = True
          chkTRXRubicson.Enabled = True
          chkTRXUndec.Enabled = True
          chkTRXX10.Enabled = True
        Case recType86800
          EnableDisableTRX(1)
          RadioButton868MHz.Value = True
        Case recType86800FSK
          EnableDisableTRX(1)
          RadioButton868MHzFSK.Value = True
        Case recType86830
          EnableDisableTRX(1)
          RadioButton86830MHz.Value = True
          chkTRXLaCrosse.Enabled = True
        Case recType86830FSK
          EnableDisableTRX(1)
          RadioButton86830MHzFSK.Value = True
          chkTRXHideki.Enabled = True
        Case recType86835
          EnableDisableTRX(1)
          RadioButton86835MHz.Value = True
          chkTRXFS20.Enabled = True
        Case recType86835FSK
          EnableDisableTRX(1)
          RadioButton86835MHzFSK.Value = True
          chkTRXProGuard.Enabled = True
        Case recType86895
          EnableDisableTRX(1)
          RadioButton86895MHz.Value = True
          chkTRXVisonic.Enabled = True
      End Select

      chkTRXUndec.Value = $TRXControllerInfo["protocols"].Exist("Undec")
      chkTRXX10.Value = $TRXControllerInfo["protocols"].Exist("X10")
      chkTRXARC.Value = $TRXControllerInfo["protocols"].Exist("ARC")
      chkTRXAC.Value = $TRXControllerInfo["protocols"].Exist("AC")
      chkTRXHEEU.Value = $TRXControllerInfo["protocols"].Exist("HomeEasyEU")
      chkTRXMeiantech.Value = $TRXControllerInfo["protocols"].Exist("Meiantech")
      chkTRXOregon.Value = $TRXControllerInfo["protocols"].Exist("Oregon")
      chkTRXATI.Value = $TRXControllerInfo["protocols"].Exist("ATI")
      chkTRXVisonic.Value = $TRXControllerInfo["protocols"].Exist("Visonic")
      chkTRXMertik.Value = $TRXControllerInfo["protocols"].Exist("Mertik")
      chkTRXAD.Value = $TRXControllerInfo["protocols"].Exist("AD")
      chkTRXHideki.Value = $TRXControllerInfo["protocols"].Exist("Hideki")
      chkTRXLaCrosse.Value = $TRXControllerInfo["protocols"].Exist("LaCrosse")
      chkTRXFS20.Value = $TRXControllerInfo["protocols"].Exist("FS20")
      chkTRXProGuard.Value = $TRXControllerInfo["protocols"].Exist("ProGuard")
      chkTRXBlindsT0.Value = $TRXControllerInfo["protocols"].Exist("BlindsT0")
      chkTRXBlindsT1.Value = $TRXControllerInfo["protocols"].Exist("BlindsT1")
      chkTRXAE.Value = $TRXControllerInfo["protocols"].Exist("AE")
      chkTRXRubicson.Value = $TRXControllerInfo["protocols"].Exist("RUBiCSON")
      chkTRXFineOffset.Value = $TRXControllerInfo["protocols"].Exist("FineOffset")
      chkTRXLighting4.Value = $TRXControllerInfo["protocols"].Exist("Lighting4")
      chkTRXRSL.Value = $TRXControllerInfo["protocols"].Exist("RSL")
      chkTRXByronSX.Value = $TRXControllerInfo["protocols"].Exist("ByronSX")
      chkTRXRFU6.Value = $TRXControllerInfo["protocols"].Exist("RFU6")

      txtTRXFirmwareVersion.Text = $TRXControllerInfo["firmwareversion"]
      txtTRXHardwareVersion.Text = $TRXControllerInfo["hardwareversion"]
    Else
      EnableDisableTRX(0)
      txtTRXStatus.Text = ("Not Connected")
      txtTRXStatus.Foreground = &HFF0000
      btnTRXShowError.Visible = True

      Try $TRXError = $TRXControllerInfo["errortext"]
    Endif
  Endif

End

Public Sub cmbRXList_Click()

  Dim bIsRunning As Boolean
  Dim cData As New JSONCollection

  ' Reset to blank, we use this variable to detect if an internal error happened
  $RXError = ""

  If Main.bServer Then
    Try $hRFXComRX = Plugin.GetPluginObject("RFXComRX", $RXInstanceList[cmbRXList.Index]).Interface
    If Error Then
      $RXError = "RFXComRX Object Instance '" & $RXInstanceList[cmbRXList.Index] & "' doesn't exist\nPlease report this as a bug"
    Else
      cData = New JSONCollection
      cData.Add("controller", "command")
      cData.Add("rfxcomrx", "rfxcom")
      $RXControllerInfo = $hRFXComRX.JsonRpc_Tools_RFXCom_Get(cData)
      If $RXControllerInfo = Null Then
        $RXError = "RFXComRX Object Instance '" & $RXInstanceList[cmbRXList.Index] & "' reported an empty controller info.\nPlease report this as a bug"
      Else
        If Not $RXControllerInfo.Exist("instance_id") Then
          $RXError = "RFXComRX Object Instance '" & $RXInstanceList[cmbRXList.Index] & "' doesn't have an instance id.\nPlease report this as a bug"
        Endif
      Endif
    Endif
  Else
    cData = New JSONCollection
    cData.Add("controller", "command")
    cData.Add("rfxcomrx", "rfxcom")
    cData.Add($RXInstanceList[cmbRXList.Index], "instance_id")
    $RXControllerInfo = Client.Call_Tools_RFXCom_Get(cData)

    ' Report an invalid JSON-RPC response - this shouldn't happen at this stage
    If $RXControllerInfo = Null Or If Not $RXControllerInfo.Exist("instance_id") Then
      $RXError = "Received an empty or invalid response from the JSON-RPC server.\nPlease consult the server logfile for more information"
    Endif
  Endif

  If $RXError Then
    txtRXStatus.Text = ("Not Connected")
    txtRXStatus.Foreground = &HFF0000
    btnRXShowError.Visible = True
    EnableDisableRX(False)

    Message.Error($RXError)
  Else

    Try bIsRunning = $RXControllerInfo["running"]

    If bIsRunning Then
      EnableDisableRX(True)
      txtRXStatus.Text = ("Connected")
      txtRXStatus.Foreground = &H00FF00
      btnRXShowError.Visible = False
      $RXError = ""
    Else
      EnableDisableRX(False)
      txtRXStatus.Text = ("Not Connected")
      txtRXStatus.Foreground = &HFF0000
      btnRXShowError.Visible = True
      Try $RXError = $RXControllerInfo["errortext"]
    Endif
  Endif

End

Public Sub cmbTXList_Click()

  Dim bIsRunning As Boolean
  Dim cData As New JSONCollection

  ' Reset to blank, we use this variable to detect if an internal error happened
  $TXError = ""

  If Main.bServer Then
    Try $hRFXComTX = Plugin.GetPluginObject("RFXComTX", $TXInstanceList[cmbTXList.Index]).Interface
    If Error Then
      $TXError = "RFXComTX Object Instance '" & $TXInstanceList[cmbTXList.Index] & "' doesn't exist\nPlease report this as a bug"
    Else
      cData = New JSONCollection
      cData.Add("controller", "command")
      cData.Add("rfxcomrx", "rfxcom")
      $TXControllerInfo = $hRFXComTX.JsonRpc_Tools_RFXCom_Get(cData)
      If $TXControllerInfo = Null Then
        $TXError = "RFXComTX Object Instance '" & $TXInstanceList[cmbTXList.Index] & "' reported an empty controller info.\nPlease report this as a bug"
      Else
        If Not $TXControllerInfo.Exist("instance_id") Then
          $TXError = "RFXComTX Object Instance '" & $TXInstanceList[cmbTXList.Index] & "' doesn't have an instance id.\nPlease report this as a bug"
        Endif
      Endif
    Endif
  Else
    cData = New JSONCollection
    cData.Add("controller", "command")
    cData.Add("rfxcomtx", "rfxcom")
    cData.Add($TXInstanceList[cmbTXList.Index], "instance_id")
    $TXControllerInfo = Client.Call_Tools_RFXCom_Get(cData)

    ' Report an invalid JSON-RPC response - this shouldn't happen at this stage
    If $TXControllerInfo = Null Or If Not $TXControllerInfo.Exist("instance_id") Then
      $TXError = "Received an empty or invalid response from the JSON-RPC server.\nPlease consult the server logfile for more information"
    Endif
  Endif

  If $TXError Then
    txtTXStatus.Text = ("Not Connected")
    txtTXStatus.Foreground = &HFF0000
    btnTXShowError.Visible = True
    EnableDisableTX(False)

    Message.Error($TXError)
  Else

    Try bIsRunning = $TXControllerInfo["running"]

    If bIsRunning Then
      EnableDisableTX(True)
      txtTXStatus.Text = ("Connected")
      txtTXStatus.Foreground = &H00FF00
      btnTXShowError.Visible = False
      $TXError = ""
    Else
      EnableDisableTX(False)
      txtTXStatus.Text = ("Not Connected")
      txtTXStatus.Foreground = &HFF0000
      btnTXShowError.Visible = True
      Try $TXError = $TXControllerInfo["errortext"]
    Endif
  Endif

End

Public Sub btnTRXShowError_Click()

  Message.Error($TRXError)

End

Public Sub btnRXShowError_Click()

  Message.Error($RXError)  

End

Public Sub btnTXShowError_Click()

  Message.Error($TXError)  

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Security1 command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Security1(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Security1(cmbSecurity1Type.Text, "0x" & cmbSecurity1ID1.Text & cmbSecurity1ID2.Text & cmbSecurity1ID3.Text, sCommand)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "security1"
    cData["type"] = cmbSecurity1Type.Text
    cData["address"] = "0x" & cmbSecurity1ID1.Text & cmbSecurity1ID2.Text & cmbSecurity1ID3.Text
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnSecurity1Normal_Click()

  Command_Security1("NORMAL")

End

Public Sub btnSecurity1Alarm_Click()

  Command_Security1("ALARM")

End

Public Sub btnSecurity1Motion_Click()

  Command_Security1("MOTION")

End

Public Sub btnSecurity1ArmAway_Click()

  Command_Security1("ARM AWAY")

End

Public Sub btnSecurity1DisArm_Click()

  Command_Security1("DISARM")

End

Public Sub btnSecurity1NormalDelay_Click()

  Command_Security1("NORMAL DELAY")

End

Public Sub btnSecurity1NoMotion_Click()

  Command_Security1("NO MOTION")

End

Public Sub btnSecurity1ArmAwayDelay_Click()

  Command_Security1("ARM AWAY DELAYED")

End

Public Sub btnSecurity1Light1On_Click()

  Command_Security1("LIGHT 1 ON")

End

Public Sub btnSecurity1Panic_Click()

  Command_Security1("PANIC")

End

Public Sub btnSecurity1ArmHome_Click()

  Command_Security1("ARM HOME")

End

Public Sub btnSecurity1Light1Off_Click()

  Command_Security1("LIGHT 1 OFF")

End

Public Sub btnSecurity1AlarmDelay_Click()

  Command_Security1("ALARM DELAYED")

End

Public Sub btnSecurity1EndPanic_Click()

  Command_Security1("END PANIC")

End

Public Sub btnSecurity1ArmHomeDelay_Click()

  Command_Security1("ARM HOME DELAYED")

End

Public Sub btnSecurity1Light2On_Click()

  Command_Security1("LIGHT 2 ON")

End

Public Sub btnSecurity1Dark_Click()

  Command_Security1("DARK")

End

Public Sub btnSecurity1BattLow_Click()

  Command_Security1("BATTERY LOW")

End

Public Sub btnSecurity1Light2Off_Click()

  Command_Security1("LIGHT 2 OFF")

End

Public Sub btnSecurity1Light_Click()

  Command_Security1("LIGHT")

End

Public Sub btnSecurity1Pair_Click()

  Command_Security1("PAIR")

End

Public Sub btnSecurity1NormalTamper_Click()

  Command_Security1("NORMAL+TAMPER")

End

Public Sub btnSecurity1NormalDelayTamper_Click()

  Command_Security1("NORMAL DELAYED+TAMPER")

End

Public Sub btnSecurity1AlarmTamper_Click()

  Command_Security1("ALARM+TAMPER")

End

Public Sub btnSecurity1AlarmDelayTamper_Click()

  Command_Security1("ALARM DELAYED+TAMPER")

End

Public Sub btnSecurity1MotionTamper_Click()

  Command_Security1("MOTION+TAMPER")

End

Public Sub btnSecurity1NoMotionTamper_Click()

  Command_Security1("NO MOTION+TAMPER")

End

Public Sub btnSecurity1IRbeam_Click()

  Command_Security1("IRBEAM")

End

Public Sub cmbSecurity1Type_Click()

  SetSecurity1Commands(cmbSecurity1Type.Index)

End

Public Sub cmbSecurity1ID1_Click()

  If cmbSecurity1Type.Index = 0 Then
    If cmbSecurity1ID2.Index <> cmbSecurity1ID1.Index Xor &HF Then
      cmbSecurity1ID2.Index = cmbSecurity1ID1.Index Xor &HF
    Endif
  Endif
  tbSecurity1Address.Text = "0x" & cmbSecurity1ID1.Text & cmbSecurity1ID2.Text & cmbSecurity1ID3.Text

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Fan command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Fan(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Fan(cmbFanType.Text, "0x" & cmbFanID1.Text & cmbFanID2.Text & cmbFanID3.Text, sCommand)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "fan"
    cData["type"] = cmbFanType.Text
    cData["address"] = "0x" & cmbFanID1.Text & cmbFanID2.Text & cmbFanID3.Text
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnFanTimer_Click()

  Command_Fan("TIMER")

End

Public Sub btnFanLearn_Click()

  Command_Fan("LEARN")

End

Public Sub btnFanConfirm_Click()

  Command_Fan("CONFIRM")

End

Public Sub btnFanPlus_Click()

  Command_Fan("+")

End

Public Sub btnFanMinus_Click()

  Command_Fan("-")

End

Public Sub btnFanLight_Click()

  Command_Fan("LIGHT")

End

Public Sub cmbFanType_Click()

  SetFanCommands(cmbFanType.Index)

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Fan command, buttons, etc
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_RFY(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.RFY(cmbRFYType.Text, "0x" & cmbRFYID1.Text & cmbRFYID2.Text & cmbRFYID3.Text & " " & cmbRFYUnit.Text, sCommand)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "rfy"
    cData["type"] = cmbRFYType.Text
    cData["address"] = "0x" & cmbRFYID1.Text & cmbRFYID2.Text & cmbRFYID3.Text & " " & cmbRFYUnit.Text
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnRFYStop_Click()

  Command_RFY("STOP")

End

Public Sub btnRFYUp_Click()

  Command_RFY("UP")

End

Public Sub btnRFYUpStop_Click()

  Command_RFY("UPSTOP")

End

Public Sub btnRFYProgram_Click()

  Command_RFY("PROGRAM")

End

Public Sub btnRFYUpDown_Click()

  Command_RFY("UPDOWN")

End

Public Sub btnRFYStop2Sec_Click()

  Command_RFY("STOP2S")

End

Public Sub btnRFYDown_Click()

  Command_RFY("DOWN")

End

Public Sub btnRFYDownStop_Click()

  Command_RFY("DOWNSTOP")

End

Public Sub btnRFYProgram2Sec_Click()

  Command_RFY("PROGRAM2S")

End

Public Sub btnRFYUpDown5Sec_Click()

  Command_RFY("UPDOWN5S")

End

Public Sub btnRFYStop5Sec_Click()

  Command_RFY("STOP5S")

End

Public Sub btnRFYProgram7Sec_Click()

  Command_RFY("PROGRAM7S")

End

Public Sub btnRFYEraseRemote_Click()

  Command_RFY("ERASE")

End

Public Sub btnRFYEraseAll_Click()

  Command_RFY("ERASEALL")

End

Public Sub btnRFYRemotes_Click()

  Command_RFY("REMOTES")
  Balloon("List of RFY remotes written to (server) debug log", btnRFYRemotes)

End


Public Sub btnFRYSunFlag_Click()

  Command_RFY("ENSUNFLAG")

End

Public Sub btnRFYDisableSun_Click()

  Command_RFY("DISSUNFLAG")

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' Radiator1 command
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Private Sub Command_Radiator1(sCommand As String)

  Dim cData As New JSONCollection

  If Main.bServer Then
    $hRFXComTRX.Radiator1(cmbRadiator1Type.Text, "0x" & cmbRadiator1ID1.Text & cmbRadiator1ID2.Text & cmbRadiator1ID3.Text & cmbRadiator1ID4.Text & " " & cmbRadiator1Unit.Text, sCommand)
  Else
    cData["rfxcom"] = "rfxcomtrx"
    cData["instance_id"] = $TRXInstanceList[cmbTRXList.Index]
    cData["function"] = "radiator1"
    cData["type"] = cmbRadiator1Type.Text
    cData["address"] = "0x" & cmbRadiator1ID1.Text & cmbRadiator1ID2.Text & cmbRadiator1ID3.Text & cmbRadiator1ID4.Text & " " & cmbRadiator1Unit.Text
    cData["command"] = sCommand
    Client.Call_Tools_RFXCom_Set(cData)
  Endif

End

Public Sub btnRadiator1Night_Click()

  Command_Radiator1("NIGHT")

End

Public Sub btnRadiator1Day_Click()

  Command_Radiator1("DAY")

End

Public Sub btnRadiatorSetTemp_Click()

  Command_Radiator1("SP " & cmbRadiator1Temp.Text)

End

Public Sub cmbRadiator1ID1_Click()

  tbRadiator1Address.Text = "0x" & cmbRadiator1ID1.Text & cmbRadiator1ID2.Text & cmbRadiator1ID3.Text & cmbRadiator1ID4.Text & " " & cmbRadiator1Unit.Text

End

Public Sub cmbRadiator1ID2_Click()

  tbRadiator1Address.Text = "0x" & cmbRadiator1ID1.Text & cmbRadiator1ID2.Text & cmbRadiator1ID3.Text & cmbRadiator1ID4.Text & " " & cmbRadiator1Unit.Text

End

Public Sub cmbRadiator1ID3_Click()

  tbRadiator1Address.Text = "0x" & cmbRadiator1ID1.Text & cmbRadiator1ID2.Text & cmbRadiator1ID3.Text & cmbRadiator1ID4.Text & " " & cmbRadiator1Unit.Text

End

Public Sub cmbRadiator1ID4_Click()

  tbRadiator1Address.Text = "0x" & cmbRadiator1ID1.Text & cmbRadiator1ID2.Text & cmbRadiator1ID3.Text & cmbRadiator1ID4.Text & " " & cmbRadiator1Unit.Text

End

Public Sub cmbRadiator1Unit_Click()

  tbRadiator1Address.Text = "0x" & cmbRadiator1ID1.Text & cmbRadiator1ID2.Text & cmbRadiator1ID3.Text & cmbRadiator1ID4.Text & " " & cmbRadiator1Unit.Text

End

Public Sub cmbRFYID1_Click()

  tbRFYAddress.Text = "0x" & cmbRFYID1.Text & cmbRFYID2.Text & cmbRFYID3.Text & " " & cmbRFYUnit.Text

End

Public Sub cmbRFYID2_Click()

  tbRFYAddress.Text = "0x" & cmbRFYID1.Text & cmbRFYID2.Text & cmbRFYID3.Text & " " & cmbRFYUnit.Text

End

Public Sub cmbRFYID3_Click()

  tbRFYAddress.Text = "0x" & cmbRFYID1.Text & cmbRFYID2.Text & cmbRFYID3.Text & " " & cmbRFYUnit.Text

End

Public Sub cmbRFYUnit_Click()

  tbRFYAddress.Text = "0x" & cmbRFYID1.Text & cmbRFYID2.Text & cmbRFYID3.Text & " " & cmbRFYUnit.Text

End

Public Sub btnRFYCopy_Click()

  If Not tbRFYAddress.Text Then Return
  Clipboard.Copy(tbRFYAddress.Text, "text/plain")
  Balloon.Info("'" & tbRFYAddress.Text & "' copied to clipboard", tbRFYAddress)

End

Public Sub btnRadiator1Copy_Click()

  If Not tbRadiator1Address.Text Then Return
  Clipboard.Copy(tbRadiator1Address.Text, "text/plain")
  Balloon.Info("'" & tbRadiator1Address.Text & "' copied to clipboard", tbRadiator1Address)

End

Public Sub cmbSecurity1ID3_Click()

  tbSecurity1Address.Text = "0x" & cmbSecurity1ID1.Text & cmbSecurity1ID2.Text & cmbSecurity1ID3.Text

End

Public Sub btnLighting6Copy_Click()

  If Not tbLighting6Address.Text Then Return
  Clipboard.Copy(tbLighting6Address.Text, "text/plain")
  Balloon.Info("'" & tbLighting6Address.Text & "' copied to clipboard", tbLighting6Address)

End

Public Sub cmbLighting6ID1_Click()

  tbLighting6Address.Text = cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text

End

Public Sub cmbLighting6ID2_Click()

  tbLighting6Address.Text = cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text

End

Public Sub cmbLighting6Group_Click()

  tbLighting6Address.Text = cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text

End

Public Sub cmbLighting6Unit_Click()

  tbLighting6Address.Text = cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text

End

Public Sub cmbThermostat2Unit_Click()

  tbThermostat2Address.Text = cmbThermostat2Unit.Text

End

Public Sub btnSecurity1Copy_Click()

  If Not tbSecurity1Address.Text Then Return
  Clipboard.Copy(tbSecurity1Address.Text, "text/plain")
  Balloon.Info("'" & tbSecurity1Address.Text & "' copied to clipboard", tbSecurity1Address)

End

Public Sub btnLighting5Copy_Click()

  If Not tbLighting5Address.Text Then Return
  Clipboard.Copy(tbLighting5Address.Text, "text/plain")
  Balloon.Info("'" & tbLighting5Address.Text & "' copied to clipboard", tbLighting5Address)

End

Public Sub cmbLighting5ID1_Click()

  tbLighting5Address.Text = "0x" & cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text

End

Public Sub cmbLighting5ID2_Click()

  tbLighting5Address.Text = "0x" & cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text

End

Public Sub cmbLighting5ID3_Click()

  tbLighting5Address.Text = "0x" & cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text

End

Public Sub cmbLighting5Unit_Click()

  tbLighting5Address.Text = "0x" & cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text

End

Public Sub btnLighting2Copy_Click()

  If Not tbLighting2Address.Text Then Return
  Clipboard.Copy(tbLighting2Address.Text, "text/plain")
  Balloon.Info("'" & tbLighting2Address.Text & "' copied to clipboard", tbLighting2Address)

End

Public Sub cmbLighting2ID1_Click()

  tbLighting2Address.Text = "0x" & cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text

End

Public Sub cmbLighting2ID2_Click()

  tbLighting2Address.Text = "0x" & cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text

End

Public Sub cmbLighting2ID3_Click()

  tbLighting2Address.Text = "0x" & cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text

End

Public Sub cmbLighting2ID4_Click()

  tbLighting2Address.Text = "0x" & cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text

End

Public Sub cmbLighting2Unit_Click()

  tbLighting2Address.Text = "0x" & cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text

End

Public Sub btnLighting1Copy_Click()

  If Not tbLighting1Address.Text Then Return
  Clipboard.Copy(tbLighting1Address.Text, "text/plain")
  Balloon.Info("'" & tbLighting1Address.Text & "' copied to clipboard", tbLighting1Address)

End

Public Sub cmbLighting1House_Click()

  tbLighting1Address.Text = cmbLighting1House.Text & Format(cmbLighting1Unit.Text, "00")

End

Public Sub cmbLighting1Unit_Click()

  tbLighting1Address.Text = cmbLighting1House.Text & Format(cmbLighting1Unit.Text, "00")

End

Public Sub btnFanCopy_Click()

  If Not tbFanAddress.Text Then Return
  Clipboard.Copy(tbFanAddress.Text, "text/plain")
  Balloon.Info("'" & tbFanAddress.Text & "' copied to clipboard", tbFanAddress)

End

Public Sub cmbFanID1_Click()

  tbFanAddress.Text = "0x" & cmbFanID1.Text & cmbFanID2.Text & cmbFanID3.Text

End

Public Sub cmbFanID2_Click()

  tbFanAddress.Text = "0x" & cmbFanID1.Text & cmbFanID2.Text & cmbFanID3.Text

End

Public Sub cmbFanID3_Click()

  tbFanAddress.Text = "0x" & cmbFanID1.Text & cmbFanID2.Text & cmbFanID3.Text

End

Public Sub btnCurtainCopy_Click()

  If Not tbCurtain1Address.Text Then Return
  Clipboard.Copy(tbCurtain1Address.Text, "text/plain")
  Balloon.Info("'" & tbCurtain1Address.Text & "' copied to clipboard", tbCurtain1Address)

End

Public Sub cmbCurtainHouse_Click()

   tbCurtain1Address.Text = cmbCurtainHouse.Text & Format(cmbCurtainUnit.Text, "00")

End

Public Sub cmbCurtainUnit_Click()

  tbCurtain1Address.Text = cmbCurtainHouse.Text & Format(cmbCurtainUnit.Text, "00")

End

Public Sub btnChimeCopy_Click()

  If Not tbChimeAddress.Text Then Return
  Clipboard.Copy(tbChimeAddress.Text, "text/plain")
  Balloon.Info("'" & tbChimeAddress.Text & "' copied to clipboard", tbChimeAddress)

End

Public Sub cmbChimeUnit_Click()

  tbChimeAddress.Text = cmbChimeUnit.Text

End

Public Sub btnThermostat2Copy_Click()

  If Not tbThermostat2Address.Text Then Return
  Clipboard.Copy(tbThermostat2Address.Text, "text/plain")
  Balloon.Info("'" & tbThermostat2Address.Text & "' copied to clipboard", tbThermostat2Address)

End
