' Gambas class file

' Description:
' FToolsRFXComCmdr.class
' Allows injection of a packet to test RFXCom module parser.
' Provides functions like RFXCom's Manager.

' Development Status:
' Works.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

' transceiver / receiver / transmitter
Const recType310 As Byte = &H50
Const recType315 As Byte = &H51
Const recType43392 As Byte = &H52
Const trxType43392 As Byte = &H53
Const recType86800 As Byte = &H55
Const recType86800FSK As Byte = &H56
Const recType86830 As Byte = &H57
Const recType86830FSK As Byte = &H58
Const recType86835 As Byte = &H59
Const recType86835FSK As Byte = &H5A
Const recType86895 As Byte = &H5B

' interface commands
Const msg3undec As Byte = &H80
Const msg3RFU6 As Byte = &H40
Const msg3RFU5 As Byte = &H20
Const msg3RFU4 As Byte = &H10
Const msg3LIGHTING4 As Byte = &H8
Const msg3FINEOFFSET As Byte = &H4
Const msg3RUBICSON As Byte = &H2
Const msg3AE As Byte = &H1

Const msg4BlindsT1 As Byte = &H80
Const msg4BlindsT0 As Byte = &H40
Const msg4PROGUARD As Byte = &H20
Const msg4FS20 As Byte = &H10
Const msg4LCROS As Byte = &H8
Const msg4HID As Byte = &H4
Const msg4AD As Byte = &H2
Const msg4MERTIK As Byte = &H1

Const msg5VISONIC As Byte = &H80
Const msg5ATI As Byte = &H40
Const msg5OREGON As Byte = &H20
Const msg5MEI As Byte = &H10
Const msg5HEU As Byte = &H8
Const msg5AC As Byte = &H4
Const msg5ARC As Byte = &H2
Const msg5X10 As Byte = &H1

Private hRFXComRX As Object
Private hRFXComTRX As Object
Private hRFXComTX As Object

Private $RFXComTRXInstanceList As New Integer[]
Private $RFXComRXInstanceList As New Integer[]
Private $RFXComTXInstanceList As New Integer[]

Public Sub Form_Open()

  Dim iInstance As Integer

  Me.Move(FMain.X + 50, FMain.Y + 70)

  ' Check if 1 or more RFXComTRX are enabled
  If Plugin.IsPluginEnabled("RFXComTRX", 0) Then
 
    ' fill the combo list and auto-enable the first instance
    ' First get the list of enabled instances
    $RFXComTRXInstanceList = Plugin.GetPluginEnabledList("RFXComTRX")

    ' loop through the list and fill the combo list
    cmbTransceiverList.Clear()
    For Each iInstance In $RFXComTRXInstanceList
      cmbTransceiverList.Add("instance #" & iInstance)
    Next

    ' Auto-enable the first instance
    cmbTransceiverList.Index = 0

  Else
    ' hide transceiver tab
    TabStripRFXComCommander[0].Visible = False
  Endif

  ' Check if 1 or more RFXComRX are enabled
  If Plugin.IsPluginEnabled("RFXComRX", 0) Then
 
    ' fill the combo list and auto-enable the first instance
    ' First get the list of enabled instances
    $RFXComRXInstanceList = Plugin.GetPluginEnabledList("RFXComRX")

    ' loop through the list and fill the combo list
    cmbReceiverList.Clear()
    For Each iInstance In $RFXComRXInstanceList
      cmbReceiverList.Add("instance #" & iInstance)
    Next

    ' Auto-enable the first instance
    cmbReceiverList.Index = 0

  Else
    ' hide transceiver tab
    TabStripRFXComCommander[1].Visible = False
  Endif

  ' Check if 1 or more RFXComRX are enabled
  If Plugin.IsPluginEnabled("RFXComTX", 0) Then
 
    ' fill the combo list and auto-enable the first instance
    ' First get the list of enabled instances
    $RFXComTXInstanceList = Plugin.GetPluginEnabledList("RFXComTX")

    ' loop through the list and fill the combo list
    cmbTransmitterList.Clear()
    For Each iInstance In $RFXComTXInstanceList
      cmbTransmitterList.Add("instance #" & iInstance)
    Next

    ' Auto-enable the first instance
    cmbTransmitterList.Index = 0

  Else
    ' hide transceiver tab
    TabStripRFXComCommander[2].Visible = False
  Endif

  ' fill combo's with values
  FMain.FillCombo(cmbACDevice1, "4")
  FMain.FillCombo(cmbACDevice2, "FF")
  FMain.FillCombo(cmbACDevice3, "FF")
  FMain.FillCombo(cmbACDevice4, "FF")
  FMain.FillCombo(cmbACUnit, "16")
  FMain.FillCombo(cmbARCDevice, "16")
  FMain.FillCombo(cmbLighting1Unit, "16")

  FMain.FillCombo(cmbLighting2ID2, "FF")
  FMain.FillCombo(cmbLighting2ID3, "FF")
  FMain.FillCombo(cmbLighting2ID4, "FF")
  FMain.FillCombo(cmbLighting2Unit, "16")

  FMain.FillCombo(cmbLighting5ID1, "FF")
  FMain.FillCombo(cmbLighting5ID2, "FF")
  FMain.FillCombo(cmbLighting5ID3, "FF")
  FMain.FillCombo(cmbLighting5Unit, "16")

  FMain.FillCombo(cmbCurtainUnit, "16")
  FMain.FillCombo(cmbThermostat2Unit, "1F")

  FMain.FillCombo(cmbLighting6ID1, "FF")
  FMain.FillCombo(cmbLighting6ID2, "FF")

End

Private Sub SetLighting1Commands(iMode As Integer)

  Select iMode
    Case 0, 5 ' X10, EWM200
      btnLighting1AllOn.Enabled = True
      btnLighting1AllOff.Enabled = True
      btnLighting1Chime.Enabled = False
    Case 1 ' ARC
      btnLighting1AllOn.Enabled = True
      btnLighting1AllOff.Enabled = True
      btnLighting1Chime.Enabled = True
    Case 3, 4, 6 ' ELRO AB400, Waveman, Impuls
      btnLighting1AllOn.Enabled = False
      btnLighting1AllOff.Enabled = False
      btnLighting1Chime.Enabled = False
  End Select

End

Public Sub btnClose_Click()

  Me.Close

End

Public Sub btnInject_Click()

  hRFXComRX.bSimulate = True
  If txtPacketRX.Text Then Main.hRFXComRX.Simulate(txtPacketRX.Text)

End

Public Sub btnVersion_Click()

  hRFXComRX.GetVersion()

End

Public Sub btnEnableAll_Click()

  hRFXComRX.ProtocolSetup("ALL")

End

Public Sub btnOregon_Click()

  hRFXComRX.ProtocolSetup("OREGON")

End

Public Sub btnX10_Click()

  hRFXComRX.ProtocolSetup("X10")

End

Public Sub btnARC_Click()

  hRFXComRX.ProtocolSetup("ARC")

End

Public Sub btnKoppla_Click()

  hRFXComRX.ProtocolSetup("KOPPLA")

End

Public Sub btnATI_Click()

  hRFXComRX.ProtocolSetup("ATI")

End

Public Sub btnVisonic_Click()

  hRFXComRX.ProtocolSetup("VISONIC")

End

Public Sub btnSomfy_Click()

  hRFXComRX.ProtocolSetup("SOMFY")

End

Public Sub btnHEUK_Click()

  hRFXComRX.ProtocolSetup("HEUK")

End

Public Sub btnHEEU_Click()

  hRFXComRX.ProtocolSetup("HEEU")

End

Public Sub EnableDisableRX(bEnable As Boolean)

  btnSomfy.Enabled = bEnable
  btnVisonic.Enabled = bEnable
  btnATI.Enabled = bEnable
  btnKoppla.Enabled = bEnable
  btnARC.Enabled = bEnable
  btnX10.Enabled = bEnable
  btnOregon.Enabled = bEnable
  btnHEUK.Enabled = bEnable
  btnHEEU.Enabled = bEnable
  btnVersion.Enabled = bEnable
  btnEnableAll.Enabled = bEnable
  btnInject.Enabled = bEnable
  txtPacketRX.Enabled = bEnable

End

Public Sub EnableDisableTX(bEnable As Boolean)

  btnVersionTX.Enabled = bEnable
  btnEnableARCTX.Enabled = bEnable
  btnEnableHarrisonTX.Enabled = bEnable
  btnDisableX10TX.Enabled = bEnable
  btnEnableKopplaTX.Enabled = bEnable
  slDim.Enabled = bEnable

  ' ARC / X10
  btnARCOn.Enabled = bEnable
  btnARCOff.Enabled = bEnable
  btnARCDim.Enabled = bEnable
  btnARCBright.Enabled = bEnable
  btnARCLightsOff.Enabled = bEnable
  btnARCLightsOn.Enabled = bEnable
  cmbARCHouse.Enabled = bEnable
  cmbARCDevice.Enabled = bEnable

  ' AC / HE UK
  cmbACDevice1.Enabled = bEnable
  cmbACDevice2.Enabled = bEnable
  cmbACDevice3.Enabled = bEnable
  cmbACDevice4.Enabled = bEnable
  cmbACUnit.Enabled = bEnable
  btnACOff.Enabled = bEnable
  btnACOn.Enabled = bEnable
  chkHEEU.Enabled = bEnable
  tbtnACGroup.Enabled = bEnable

End

' 0=Disabled, 2=Transceiver, 1=Receiver Only
Public Sub EnableDisableTRX(iType As Integer)

  btnTRXReset.Enabled = iType >= 1
  btnTRXGetStatus.Enabled = iType >= 1
  btnTRXSave.Enabled = iType >= 1
  btnTRXSetMode.Enabled = iType >= 1
  btnInjectTRX.Enabled = iType >= 1

  btnLighting1Off.Enabled = iType >= 2
  btnLighting1On.Enabled = iType >= 2
  btnLighting1AllOff.Enabled = iType >= 2
  btnLighting1AllOn.Enabled = iType >= 2
  btnLighting1Chime.Enabled = iType >= 2
  btnLighting1AllOn.Enabled = iType >= 2
  btnLighting1AllOff.Enabled = iType >= 2

  btnLighting2On.Enabled = iType >= 2
  btnLighting2Off.Enabled = iType >= 2
  btnLighting2AllOff.Enabled = iType >= 2
  btnLighting2AllOn.Enabled = iType >= 2
  slLighting2Dim.Enabled = iType >= 2

  btnLighting5On.Enabled = iType >= 2
  btnLighting5Off.Enabled = iType >= 2
  btnLighting5AllLock.Enabled = iType >= 2
  btnLighting5Close.Enabled = iType >= 2
  btnLighting5GroupOn.Enabled = iType >= 2
  btnLighting5GroupOff.Enabled = iType >= 2
  btnLighting5Lock.Enabled = iType >= 2
  btnLighting5Mood1.Enabled = iType >= 2
  btnLighting5Mood2.Enabled = iType >= 2
  btnLighting5Mood3.Enabled = iType >= 2
  btnLighting5Mood4.Enabled = iType >= 2
  btnLighting5Mood5.Enabled = iType >= 2
  btnLighting5Open.Enabled = iType >= 2
  btnLighting5Unlock.Enabled = iType >= 2
  btnLighting5Stop.Enabled = iType >= 2

  btnLighting6GroupOff.Enabled = iType >= 2
  btnLighting6GroupOn.Enabled = iType >= 2
  btnLighting6On.Enabled = iType >= 2
  btnLighting6Off.Enabled = iType >= 2

  btnCurtainClose.Enabled = iType >= 2
  btnCurtainOpen.Enabled = iType >= 2
  btnCurtainStop.Enabled = iType >= 2
  btnCurtainProgram.Enabled = iType >= 2

  btnThermostat2Off.Enabled = iType >= 2
  btnThermostat2On.Enabled = iType >= 2
  btnThermostat2Program.Enabled = iType >= 2

  ' Disable all transceiver types
  RadioButton310MHz.Value = False
  RadioButton315Mhz.Value = False
  RadioButton43392MHz.Value = False
  RadioButton868MHz.Value = False
  RadioButton868MHzFSK.Value = False
  RadioButton86830MHz.Value = False
  RadioButton86830MHzFSK.Value = False
  RadioButton86835MHz.Value = False
  RadioButton86835MHzFSK.Value = False
  RadioButton86895MHz.Value = False

  txtFirmwareVersion.Text = "UNKNOWN"
  txtHardwareVersion.Text = "UNKNOWN"

  ' Disable protocols
  chkTRXAC.Enabled = False
  chkTRXAD.Enabled = False
  chkTRXAE.Enabled = False
  chkTRXARC.Enabled = False
  chkTRXATI.Enabled = False
  chkTRXBlindsT0.Enabled = False
  chkTRXBlindsT1.Enabled = False
  chkTRXFineOffset.Enabled = False
  chkTRXFS20.Enabled = False
  chkTRXHEEU.Enabled = False
  chkTRXHideki.Enabled = False
  chkTRXLaCrosse.Enabled = False
  chkTRXLighting4.Enabled = False
  chkTRXMeiantech.Enabled = False
  chkTRXMertik.Enabled = False
  chkTRXOregon.Enabled = False
  chkTRXProGuard.Enabled = False
  chkTRXRFU4.Enabled = False
  chkTRXRFU5.Enabled = False
  chkTRXRFU6.Enabled = False
  chkTRXRubicson.Enabled = False
  chkTRXUndec.Enabled = False
  chkTRXVisonic.Enabled = False
  chkTRXX10.Enabled = False

End


Public Sub btnVersionTX_Click()

  hRFXComTX.GetVersion()

End

Public Sub btnEnableARCTX_Click()

  hRFXComTX.EnableARCTX()

End

Public Sub btnEnableHarrisonTX_Click()

  hRFXComTX.EnableHarrisonTX()

End

Public Sub btnEnableKopplaTX_Click()

  hRFXComTX.EnableKopplaTX()

End

Public Sub btnDisableX10TX_Click()

  hRFXComTX.DisableX10TX()

End

Public Sub ControlTX(sAddress As String, sCmd As String)

  hRFXComTX.X10(sAddress, sCmd)

End

' ARC
Public Sub btnARCOn_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "On")

End

Public Sub btnARCOff_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "Off")

End

Public Sub btnARCDim_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "Dim")

End

Public Sub btnARCBright_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "Bright")

End

Public Sub btnARCLightsOn_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "All_Lights_On")

End

Public Sub btnARCLightsOff_Click()

  ControlTX(cmbARCHouse.Text & Format(cmbARCDevice.Text, "00"), "All_Lights_Off")

End

' AC / HEEU
Public Sub btnACOn_Click()

  hRFXComTX.AC(cmbACDevice1.Index & cmbACDevice2.Text & cmbACDevice3.Text & cmbACDevice4.Text & " " & cmbACUnit.Text, "On", chkHEEU.Value, tbtnACGroup.Value)

End

Public Sub btnACOff_Click()

  hRFXComTX.AC(cmbACDevice1.Index & cmbACDevice2.Text & cmbACDevice3.Text & cmbACDevice4.Text & " " & cmbACUnit.Text, "Off", chkHEEU.Value, tbtnACGroup.Value)

End

Public Sub slDim_Change()

  hRFXComTX.AC(cmbACDevice1.Index & cmbACDevice2.Text & cmbACDevice3.Text & cmbACDevice4.Text & " " & cmbACUnit.Text, "Dim " & slDim.Value, chkHEEU.Value, tbtnACGroup.Value)

End

Public Sub cmbLighting1Type_Click()

  SetLighting1Commands(cmbLighting1Type.Index)

End

' TRX lighting1
Public Sub btnLighting1On_Click()

  hRFXComTRX.Lighting1(cmbLighting1Type.Text, cmbLighting1House.Text & Format(cmbLighting1Unit.Text, "00"), "ON", chkLighting1Group.Value)

End

Public Sub btnLighting1Off_Click()

  hRFXComTRX.Lighting1(cmbLighting1Type.Text, cmbLighting1House.Text & Format(cmbLighting1Unit.Text, "00"), "OFF", chkLighting1Group.Value)

End

Public Sub btnLighting1Chime_Click()

  hRFXComTRX.Lighting1(cmbLighting1Type.Text, cmbLighting1House.Text & Format(cmbLighting1Unit.Text, "00"), "CHIME", chkLighting1Group.Value)

End

Public Sub btnLighting1AllOn_Click()

  hRFXComTRX.Lighting1(cmbLighting1Type.Text, cmbLighting1House.Text & Format(cmbLighting1Unit.Text, "00"), "ALL ON", chkLighting1Group.Value)

End

Public Sub btnLighting1AllOff_Click()

  hRFXComTRX.Lighting1(cmbLighting1Type.Text, cmbLighting1House.Text & Format(cmbLighting1Unit.Text, "00"), "ALL OFF", chkLighting1Group.Value)

End

Public Sub btnLighting2On_Click()

  hRFXComTRX.Lighting2(cmbLighting2Type.Text, cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text, "ON", chkLighting2Group.Value)

End

Public Sub btnLighting2Off_Click()

  hRFXComTRX.Lighting2(cmbLighting2Type.Text, cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text, "OFF", chkLighting2Group.Value)

End

Public Sub btnLighting2AllOn_Click()

  hRFXComTRX.Lighting2(cmbLighting2Type.Text, cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text, "ALL ON", chkLighting2Group.Value)

End

Public Sub btnLighting2AllOff_Click()

  hRFXComTRX.Lighting2(cmbLighting2Type.Text, cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text, "ALL OFF", chkLighting2Group.Value)

End

Public Sub slLighting2Dim_Change()

  hRFXComTRX.Lighting2(cmbLighting2Type.Text, cmbLighting2ID1.Text & cmbLighting2ID2.Text & cmbLighting2ID3.Text & cmbLighting2ID4.Text & " " & cmbLighting2Unit.Text, "DIM " & slLighting2Dim.Value, chkLighting2Group.Value)

End

Public Sub btnTRXSave_Click()

  hRFXComTRX.ProtocolSetup("SAVE")

End

Public Sub btnTRXReset_Click()

  hRFXComTRX.ProtocolSetup("RESET")

End

Public Sub btnTRXGetStatus_Click()

  hRFXComTRX.ProtocolSetup("STATUS")

End

Public Sub btnTRXSetMode_Click()

  Dim aMsg As New Byte[4]

  aMsg[0] = &H53

  If chkTRXUndec.Value Then
    aMsg[1] = &H80
  Else
    aMsg[1] = 0
  Endif

  If chkTRXBlindsT0.Value Then
    ' All other protocol receiving is disabled if BlindsT0 enabled
    ' BlindsT0 receive is only used to read the address code of the remote
    aMsg[2] = aMsg[2] Or msg4BlindsT0
    aMsg[3] = 0
  Else
    ' msg3
    If chkTRXRFU6.Value Then
      aMsg[1] = aMsg[1] Or msg3RFU6
    Endif
    If chkTRXRFU5.Value Then
      aMsg[1] = aMsg[1] Or msg3RFU5
    Endif
    If chkTRXRFU4.Value Then
      aMsg[1] = aMsg[1] Or msg3RFU4
    Endif
    If chkTRXLighting4.Value Then
      aMsg[1] = aMsg[1] Or msg3LIGHTING4
    Endif
    If chkTRXFineOffset.Value Then
      aMsg[1] = aMsg[1] Or msg3FINEOFFSET
    Endif
    If chkTRXRubicson.Value Then
      aMsg[1] = aMsg[1] Or msg3RUBICSON
    Endif
    If chkTRXAE.Value Then
      aMsg[1] = aMsg[1] Or msg3AE
    Endif

    ' msg4
    If chkTRXBlindsT1.Value Then
      aMsg[2] = aMsg[2] Or msg4BlindsT1
    Endif
    If chkTRXProGuard.Value Then
      aMsg[2] = aMsg[2] Or msg4PROGUARD
    Endif
    If chkTRXFS20.Value Then
      aMsg[2] = aMsg[2] Or msg4FS20
    Endif
    If chkTRXLaCrosse.Value Then
      aMsg[2] = aMsg[2] Or msg4LCROS
    Endif
    If chkTRXHideki.Value Then
      aMsg[2] = aMsg[2] Or msg4HID
    Endif
    If chkTRXAD.Value Then
      aMsg[2] = aMsg[2] Or msg4AD
    Endif
    If chkTRXMertik.Value Then
      aMsg[2] = aMsg[2] Or msg4MERTIK
    Endif

    ' msg5
    If chkTRXVisonic.Value Then
      aMsg[3] = aMsg[3] Or msg5VISONIC
    Endif
    If chkTRXATI.Value Then
      aMsg[3] = aMsg[3] Or msg5ATI
    Endif
    If chkTRXOregon.Value Then
      aMsg[3] = aMsg[3] Or msg5Oregon
    Endif
    If chkTRXMeiantech.Value Then
      aMsg[3] = aMsg[3] Or msg5MEI
    Endif
    If chkTRXHEEU.Value Then
      aMsg[3] = aMsg[3] Or msg5HEU
    Endif
    If chkTRXAC.Value Then
      aMsg[3] = aMsg[3] Or msg5AC
    Endif
    If chkTRXARC.Value Then
      aMsg[3] = aMsg[3] Or msg5ARC
    Endif
    If chkTRXX10.Value Then
      aMsg[3] = aMsg[3] Or msg5X10
    Endif
  Endif
  hRFXComTRX.ProtocolSetup("SETMODE", aMsg)

End

Public Sub btnInjectTRX_Click()

  hRFXComTRX.Simulate(txtPacketTRX.Text)

End

Public Sub btnLighting5On_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "ON")

End

Public Sub btnLighting5Off_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "OFF")

End

Public Sub btnLighting5GrpOff_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "GROUP OFF")

End

Public Sub btnLighting5GrpOn_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "GROUP ON")

End

Public Sub btnLighting5Mood1_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "MOOD1")

End

Public Sub btnLighting5Mood2_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "MOOD2")

End

Public Sub btnLighting5Mood3_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "MOOD3")

End

Public Sub btnLighting5Mood4_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "MOOD4")

End

Public Sub btnLighting5Mood5_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "MOOD5")

End

Public Sub btnLighting5Close_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "CLOSe")

End

Public Sub btnLighting5Stop_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "STOP")

End

Public Sub btnLighting5Open_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "OPEN")

End

Public Sub btnLighting5Unlock_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "UNLOCK")

End

Public Sub btnLighting5Lock_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "LOCK")

End

Public Sub btnLighting5AllLock_Click()

  hRFXComTRX.Lighting5(cmbLighting5Type.Text, cmbLighting5ID1.Text & cmbLighting5ID2.Text & cmbLighting5ID3.Text & " " & cmbLighting5Unit.Text, "ALL LOCK")

End

Public Sub btnLighting6On_Click()

  hRFXComTRX.Lighting6(cmbLighting6Type.Text, cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text, "ON")

End

Public Sub btnLighting6Off_Click()

  hRFXComTRX.Lighting6(cmbLighting6Type.Text, cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text, "OFF")

End

Public Sub btnLighting6GroupOff_Click()

  hRFXComTRX.Lighting6(cmbLighting6Type.Text, cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text, "GROUP OFF")

End

Public Sub btnLighting6GroupOn_Click()

  hRFXComTRX.Lighting6(cmbLighting6Type.Text, cmbLighting6ID1.Text & cmbLighting6ID2.Text & " " & cmbLighting6Group.Text & cmbLighting6Unit.Text, "GROUP ON")

End

Public Sub btnCurtainOpen_Click()

  hRFXComTRX.Curtain(cmbCurtainType.Text, cmbCurtainHouse.Text & Format(cmbCurtainUnit.Text, "00"), "OPEN")

End

Public Sub btnCurtainClose_Click()

  hRFXComTRX.Curtain(cmbCurtainType.Text, cmbCurtainHouse.Text & Format(cmbCurtainUnit.Text, "00"), "CLOSE")

End

Public Sub btnCurtainStop_Click()

  hRFXComTRX.Curtain(cmbCurtainType.Text, cmbCurtainHouse.Text & Format(cmbCurtainUnit.Text, "00"), "STOP")

End

Public Sub btnCurtainProgram_Click()

  hRFXComTRX.Curtain(cmbCurtainType.Text, cmbCurtainHouse.Text & Format(cmbCurtainUnit.Text, "00"), "PROGRAM")

End

Public Sub btnThermostat2On_Click()

  hRFXComTRX.Thermostat2(cmbThermostat2Type.Text, cmbThermostat2Unit.Text, "ON")

End

Public Sub btnThermostat2Off_Click()

  hRFXComTRX.Thermostat2(cmbThermostat2Type.Text, cmbThermostat2Unit.Text, "OFF")

End

Public Sub btnThermostat2Program_Click()

  hRFXComTRX.Thermostat2(cmbThermostat2Type.Text, cmbThermostat2Unit.Text, "PROGRAM")

End

Public Sub cmbTransceiverList_Click()

  Dim aEnabledProtocols As New String[]

  Try hRFXComTRX = Plugin.GetPluginObject("RFXComTRX", $RFXComTRXInstanceList[cmbTransceiverList.Index]).Interface
  If Error Then
    EnableDisableTRX(0)
  Else

    If hRFXComTRX.IsRunning Then
      SetLighting1Commands(cmbLighting1Type.Index)

      ' set the type in the main
      Select hRFXComTRX.GetReceiverType()
        Case recType310
          EnableDisableTRX(1)
          RadioButton310MHz.Value = True
          chkTRXX10.Enabled = True
        Case recType315
          EnableDisableTRX(1)
          RadioButton315Mhz.Value = True
          chkTRXVisonic.Enabled = True
        Case recType43392, trxType43392
          If hRFXComTRX.GetReceiverType() = recType43392 Then
            EnableDisableTRX(1)
          Else
            EnableDisableTRX(2)
          Endif

          RadioButton43392MHz.Value = True
          chkTRXAC.Enabled = True
          chkTRXAD.Enabled = True
          chkTRXAE.Enabled = True
          chkTRXARC.Enabled = True
          chkTRXATI.Enabled = True
          chkTRXBlindsT0.Enabled = True
          chkTRXBlindsT1.Enabled = True
          chkTRXFineOffset.Enabled = True
          chkTRXHEEU.Enabled = True
          chkTRXHideki.Enabled = True
          chkTRXLaCrosse.Enabled = True
          chkTRXLighting4.Enabled = True
          chkTRXMeiantech.Enabled = True
          chkTRXMertik.Enabled = True
          chkTRXOregon.Enabled = True
          'chkTRXRFU4.Enabled = True
          'chkTRXRFU5.Enabled = True
          'chkTRXRFU6.Enabled = True
          chkTRXRubicson.Enabled = True
          chkTRXUndec.Enabled = True
          chkTRXX10.Enabled = True
        Case recType86800
          EnableDisableTRX(1)
          RadioButton868MHz.Value = True
        Case recType86800FSK
          EnableDisableTRX(1)
          RadioButton868MHzFSK.Value = True
        Case recType86830
          EnableDisableTRX(1)
          RadioButton86830MHz.Value = True
          chkTRXLaCrosse.Enabled = True
        Case recType86830FSK
          EnableDisableTRX(1)
          RadioButton86830MHzFSK.Value = True
          chkTRXHideki.Enabled = True
        Case recType86835
          EnableDisableTRX(1)
          RadioButton86835MHz.Value = True
          chkTRXFS20.Enabled = True
        Case recType86835FSK
          EnableDisableTRX(1)
          RadioButton86835MHzFSK.Value = True
          chkTRXProGuard.Enabled = True
        Case recType86895
          EnableDisableTRX(1)
          RadioButton86895MHz.Value = True
          chkTRXVisonic.Enabled = True
      End Select

      aEnabledProtocols = hRFXComTRX.GetEnabledProtocols()
      chkTRXUndec.Value = aEnabledProtocols.Exist("Undec")
      chkTRXX10.Value = aEnabledProtocols.Exist("X10")
      chkTRXARC.Value = aEnabledProtocols.Exist("ARC")
      chkTRXAC.Value = aEnabledProtocols.Exist("AC")
      chkTRXHEEU.Value = aEnabledProtocols.Exist("HomeEasyEU")
      chkTRXMeiantech.Value = aEnabledProtocols.Exist("Meiantech")
      chkTRXOregon.Value = aEnabledProtocols.Exist("Oregon")
      chkTRXATI.Value = aEnabledProtocols.Exist("ATI")
      chkTRXVisonic.Value = aEnabledProtocols.Exist("Visonic")
      chkTRXMertik.Value = aEnabledProtocols.Exist("Mertik")
      chkTRXAD.Value = aEnabledProtocols.Exist("AD")
      chkTRXHideki.Value = aEnabledProtocols.Exist("Hideki")
      chkTRXLaCrosse.Value = aEnabledProtocols.Exist("LaCrosse")
      chkTRXFS20.Value = aEnabledProtocols.Exist("FS20")
      chkTRXProGuard.Value = aEnabledProtocols.Exist("ProGuard")
      chkTRXBlindsT0.Value = aEnabledProtocols.Exist("BlindsT0")
      chkTRXBlindsT1.Value = aEnabledProtocols.Exist("BlindsT1")
      chkTRXAE.Value = aEnabledProtocols.Exist("AE")
      chkTRXRubicson.Value = aEnabledProtocols.Exist("RUBiCSON")
      chkTRXFineOffset.Value = aEnabledProtocols.Exist("FineOffset")
      chkTRXLighting4.Value = aEnabledProtocols.Exist("Lighting4")
      chkTRXRFU4.Value = aEnabledProtocols.Exist("RFU4")
      chkTRXRFU5.Value = aEnabledProtocols.Exist("RFU5")
      chkTRXRFU6.Value = aEnabledProtocols.Exist("RFU6")

      txtFirmwareVersion.Text = hRFXComTRX.GetFirmwareVersion()
      txtHardwareVersion.Text = hRFXComTRX.GetHardwareVersion()
    Else
      EnableDisableTRX(0)
    Endif
  Endif

End

Public Sub cmbReceiverList_Click()

  Try hRFXComRX = Plugin.GetPluginObject("RFXComRX", $RFXComRXInstanceList[cmbReceiverList.Index]).Interface
  If Error Then
    EnableDisableRX(False)
  Else
    EnableDisableRX(hRFXComRX.IsRunning)
  Endif

End

Public Sub cmbTransmitterList_Click()

  Try hRFXComTX = Plugin.GetPluginObject("RFXComTX", $RFXComTXInstanceList[cmbTransmitterList.Index]).Interface
  If Error Then
    EnableDisableTX(False)
  Else
    EnableDisableTX(hRFXComTX.IsRunning)
  Endif

End
