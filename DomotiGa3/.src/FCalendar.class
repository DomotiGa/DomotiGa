' Gambas class file

' Description:
' FCalendar.class
' Support for calendar.

' Development Status:
' Working.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

Public Sub Form_Open()

  Dim d As Date

  Me.Move(FMain.X + 50, FMain.Y + 70)

  If Main.bServer = False Then Client.GetPlanning()

  For Each d In Calendar.dPlanning
    dcPlanning.Colors[d] = Color.DarkCyan
  Next

End

Public Sub dcPlanning_Change()

  dcPlanning.Colors[dcPlanning.Value] = Color.DarkCyan
  If Calendar.dPlanning.Find(dcPlanning.Value) = -1 Then Calendar.dPlanning.Add(dcPlanning.Value)

End

Public Sub dcPlanning_Activate()

  dcPlanning.Colors[dcPlanning.Value] = Color.White
  Try Calendar.dPlanning.Remove(Calendar.dPlanning.Find(dcPlanning.Value))

End

Public Sub btOk_Click()

  Calendar.Run()
  If Main.bServer = False Then Client.SetPlanning()
  Me.Close()

End
