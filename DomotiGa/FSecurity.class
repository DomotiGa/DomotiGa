' Gambas class file

' Description:
' FSecurity.class
' Future security page. (door/window sensor status etc)

' Development Status:
' No started yet.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008 Ron Klinkien

' Read file called LICENSE for license details.

PRIVATE tRefresh AS Timer
PRIVATE bAutoRefresh AS Boolean

PUBLIC SUB Form_Open()

  Main.DisplaySecurity("Security", FSecurity.vpnlSecurity)

  ' create refresh timer
  tRefresh = NEW Timer AS "tRefresh"
  tRefresh.Delay = 30000 ' 30 seconds

END

PUBLIC SUB Form_Resize()

  svSecurity.Move(4, 30, ME.ClientWidth - 8, ME.ClientHeight - 31)

END

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' refresh contents
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
PUBLIC SUB tRefresh_Timer()

  Main.DisplaySecurity("Security", FSecurity.vpnlSecurity)

END

PUBLIC SUB Form_Close()

  tRefresh.Stop

END

PUBLIC SUB btnRefresh_Click()

  Main.DisplaySecurity("Security", FSecurity.vpnlSecurity)

END

PUBLIC SUB tbtnRefresh_Click()

  IF tbtnRefresh.Value = TRUE THEN
    tRefresh.Start
    bAutoRefresh = TRUE
    btnRefresh.Enabled = FALSE
  ELSE
    tRefresh.Stop
    bAutoRefresh = FALSE
    btnRefresh.Enabled = TRUE
  END IF

END