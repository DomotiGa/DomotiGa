' Gambas class file

' Description:
' FLogfiles.class
' Display the different types of logs.
' Logs are not stored in db or file at the moment.
' And windows are cleared after it reached max buffers size (see main settings)

' Development Status:
' Working.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008-2009 Ron Klinkien

' Read file called COPYING for license details.

PUBLIC bPaused AS Boolean
PUBLIC iActive AS Integer = 1

PUBLIC SUB Form_Open()

  IF NOT Main.bStandalone THEN btnViewFile.Enabled = FALSE

END

PUBLIC SUB Form_Resize()

  txtMainLog.Move(4, 30, ME.ClientWidth - 10, ME.ClientHeight - 31)
  txtSpeakLog.Move(4, 30, ME.ClientWidth - 10, ME.ClientHeight - 31)
  txtDebugLog.Move(4, 30, ME.ClientWidth - 10, ME.ClientHeight - 31)
  HBox1.Width = ME.ClientWidth - 15

END

PUBLIC SUB btnMain_Click()

  txtDebugLog.Hide
  txtSpeakLog.Hide
  txtMainLog.Show
  iActive = 1

END

PUBLIC SUB btnSpeak_Click()

  txtSpeakLog.Show
  txtMainLog.Hide
  txtDebugLog.Hide
  iActive = 2

END

PUBLIC SUB btnDebug_Click()

  txtDebugLog.Show
  txtMainLog.Hide
  txtSpeakLog.Hide
  iActive = 3

END

PUBLIC SUB tbtnPause_Click()

  bPaused = tbtnPause.Value

END

PUBLIC SUB btnViewFile_Click()

  SELECT iActive
    CASE 1
      Main.OpenTextViewer(Main.sBaseDir &/ "logs" &/ Main.sMainLogfile)
    CASE 2
      Main.OpenTextViewer(Main.sBaseDir &/ "logs" &/ Main.sSpeakLogfile)
    CASE 3
      Main.OpenTextViewer(Main.sBaseDir &/ "logs" &/ Main.sDebugLogfile)
  END SELECT

END