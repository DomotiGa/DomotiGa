' Gambas class file

' Description:
' FDeviceModules.class
' Support for editing module/devicetypes/groups/locations and floorplans.

' Development Status:
' Finished and working.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

PUBLIC SUB Form_Open()

  ME.Move(FMain.X + 50, FMain.Y + 70)

  WITH DataBrowserModules.GridView
    .Columns[0].Text = ("Id")
    .Columns[0].Width = 28
    .Columns[1].Text = ("Name")
    .Columns[1].Width = 170
    .Columns[2].Text = ("Description")
    .Columns[2].Width = 160
    .Columns[3].Text = ("Type")
    .Columns[3].Width = 60
  END WITH
  WITH DataBrowserGroups.GridView
    .Columns[0].Text = ("Id")
    .Columns[0].Width = 28
    .Columns[1].Text = ("Group")
    .Columns[1].Width = 120
  END WITH
  WITH DataBrowserLocations.GridView
    .Columns[0].Text = ("Id")
    .Columns[0].Width = 28
    .Columns[1].Text = ("Location")
    .Columns[1].Width = 120
  END WITH
  WITH DataBrowserFloorplans.GridView
    .Columns[0].Text = ("Id")
    .Columns[0].Width = 28
    .Columns[1].Text = ("Floor")
    .Columns[1].Width = 120
    .Columns[2].Text = ("Image")
    .Columns[2].Width = 70
  END WITH
  WITH DataBrowserBlacklist.GridView
    .Columns[0].Text = ("Id")
    .Columns[0].Width = 28
    .Columns[1].Text = ("Address")
    .Columns[1].Width = 130
    .Columns[2].Text = ("Comments")
    .Columns[2].Width = 130
  END WITH

END

PUBLIC SUB btnClose_Click()

  ME.Close

END

PUBLIC SUB btnImageFloor_Click()

  DataControlF2.Value = FSelectImage.Run(Main.sBaseDir &/ "floorplans" &/ DataControlF1.Value, "floorplans")

END

PUBLIC SUB btnOnIcon_Click()

  DataControlM5.Value = FSelectImage.Run(Main.sBaseDir &/ "icons" &/ DataControlM5.Value, "icons")
  DisplayIcons()

END

PUBLIC SUB btnDimIcon_Click()

  DataControlM6.Value = FSelectImage.Run(Main.sBaseDir &/ "icons" &/ DataControlM6.Value, "icons")
  DisplayIcons()

END

PUBLIC SUB btnOffIcon_Click()

  DataControlM7.Value = FSelectImage.Run(Main.sBaseDir &/ "icons" &/ DataControlM7.Value, "icons")
  DisplayIcons()

END

PUBLIC SUB DisplayIcons()

  IF DataControlM5.Value THEN
    TRY mbIconOn.Path = Main.sBaseDir &/ "icons" &/ DataControlM5.Value
    IF NOT ERROR THEN mbIconOn.Playing = TRUE
  ENDIF
  IF DataControlM6.Value THEN
    TRY mbIconDim.Path = Main.sBaseDir &/ "icons" &/ DataControlM6.Value
    IF NOT ERROR THEN mbIconDim.Playing = TRUE
  ENDIF
  IF DataControlM7.Value THEN
    TRY mbIconOff.Path = Main.sBaseDir &/ "icons" &/ DataControlM7.Value
    IF NOT ERROR THEN mbIconOff.Playing = TRUE
  ENDIF

END
