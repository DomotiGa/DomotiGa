' Gambas class file

' Description:
' FCalendar.class
' Support for calendar.

' Development Status:
' Working.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

PUBLIC SUB Form_Open()

  DIM d AS Date

  ME.Move(FMain.X + 50, FMain.Y + 70)

  IF Main.bServer = FALSE THEN XMLClient.GetPlanning()

  FOR EACH d IN Calendar.dPlanning
    dcPlanning.SetDateColor(d, Color.DarkCyan)
  NEXT

END

PUBLIC SUB dcPlanning_Change()

  dcPlanning.SetDateColor(dcPlanning.Value, Color.DarkCyan)
  IF Calendar.dPlanning.Find(dcPlanning.Value) = -1 THEN Calendar.dPlanning.Add(dcPlanning.Value)

END

PUBLIC SUB dcPlanning_Activate()

  dcPlanning.SetDateColor(dcPlanning.Value, Color.White)
  TRY Calendar.dPlanning.Remove(Calendar.dPlanning.Find(dcPlanning.Value))

END

PUBLIC SUB btOk_Click()

  Calendar.Run()
  IF Main.bServer = FALSE THEN XMLClient.SetPlanning()
  ME.Close()

END