' Gambas class file

' Description:
' FEditContacts.class
' Store contact information, needed for future phonecall/callerid support.

' Development Status:
' Adding, deleting and editing contact information is working.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008 Ron Klinkien

' Read file called COPYING for license details.

PRIVATE hTextBoxBirthDay AS TextBox

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' create contacts table
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
PUBLIC SUB InitTable()

  DIM tableContact AS Table

  Main.hDB.Tables.Remove("contacts")

  tableContact = Main.hDB.Tables.Add("contacts")
  tableContact.Fields.Add("id", db.Serial)
  tableContact.Fields.Add("name", db.String, 32)
  tableContact.Fields.Add("address", db.String, 32)
  tableContact.Fields.Add("zipcode", db.String, 11)
  tableContact.Fields.Add("city", db.String, 32)
  tableContact.Fields.Add("country", db.String, 32)
  tableContact.Fields.Add("phoneno", db.String, 32)
  tableContact.Fields.Add("mobileno", db.String, 32)
  tableContact.Fields.Add("email", db.String, 32)
  tableContact.Fields.Add("cidphone", db.String, 32)
  tableContact.Fields.Add("cidmobile", db.String, 32)
  tableContact.Fields.Add("birthday", db.Date)
  tableContact.Fields.Add("holidaycard", db.Boolean)
  tableContact.Fields.Add("comments", db.String, 0)
  tableContact.PrimaryKey = ["id"]
  tableContact.Update()

END

PUBLIC SUB Form_Open()

  hTextBoxBirthDay = DataControl12.Children[0]

  ME.Move(FMain.X + 50, FMain.Y + 70)

  WITH DataBrowser1.GridView
    .Columns[0].Text = ("Id")
    .Columns[0].Width = 28
    .Columns[1].Text = ("Name")
    .Columns[1].Width = 100
    .Columns[2].Text = ("Address")
    .Columns[2].Width = 100
    .Columns[3].Text = ("Zip")
    .Columns[3].Width = 50
    .Columns[4].Text = ("City")
    .Columns[4].Width = 90
    .Columns[5].Text = ("Country")
    .Columns[5].Width = 80
    .Columns[6].Text = ("E-mail")
    .Columns[6].Width = 125
    .Columns[7].Text = ("Phone No.")
    .Columns[7].Width = 100
    .Columns[8].Text = ("Mobile No.")
    .Columns[8].Width = 100
    .Columns[9].Text = ("Phone CID")
    .Columns[9].Width = 90
    .Columns[10].Text = ("Mobile CID")
    .Columns[10].Width = 90
    .Columns[11].Text = ("Birthday")
    .Columns[11].Width = 90
    .Columns[12].Text = ("Holiday Card")
    .Columns[12].Width = 70
    .Columns[13].Text = ("Comments")
    .Columns[13].Width = 100
  END WITH

END

PUBLIC SUB btnClose_Click()

  ME.Close

END

PUBLIC SUB btnDate_Click()

  hTextBoxBirthDay.Text = FSelectDate.Run(DataControl12.Value)

END
