' Gambas class file

' Description:
' FEnergy.class
' Display all devices and graphs who belong to group 'energy'.

' Development Status:
' Working.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008 Ron Klinkien

' Read file called COPYING for license details.

PRIVATE tRefresh AS NEW Timer
PRIVATE bAutoRefresh AS Boolean
PRIVATE sRange AS String = "1h"

PUBLIC SUB Form_Open()

  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

  ' create refresh timer
  tRefresh = NEW Timer AS "tRefresh"
  tRefresh.Delay = 30000 ' 30 seconds

END

PUBLIC SUB Form_Resize()

  svGraphs.Move(4, 30, ME.ClientWidth - 8, ME.ClientHeight - 31)
  vpnlGraphs.Move(5, 31, ME.ClientWidth - 10, ME.ClientHeight - 33)

END

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' refresh contents
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
PUBLIC SUB tRefresh_Timer()

  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB Form_Close()

  tRefresh.Stop

END

PUBLIC SUB btnOverview_Click()

  sRange = "1h"
  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB btnGraphs2h_Click()

  sRange = "2h"
  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB btnGraphs1d_Click()

  sRange = "1d"
  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB btnGraphs2d_Click()

  sRange = "2d"
  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB btnGraphs1w_Click()

  sRange = "1w"
  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB btnGraphs2w_Click()

  sRange = "2w"
  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB btnGraphs1m_Click()

  sRange = "1m"
  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB btnGraphs1y_Click()

  sRange = "1y"
  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB btnRefresh_Click()

  Main.DisplayGraphs(sRange, "Energy", FEnergy.vpnlGraphs)

END

PUBLIC SUB tbtnRefresh_Click()

  IF tbtnRefresh.Value = TRUE THEN
    tRefresh.Start
    bAutoRefresh = TRUE
    btnRefresh.Enabled = FALSE
  ELSE
    tRefresh.Stop
    bAutoRefresh = FALSE
    btnRefresh.Enabled = TRUE
  END IF

END
