' Gambas class file

' Description:
' FToolsRFXComCmdr.class
' Allows injection of a packet to test RFXCom module parser.
' Provides functions like the RFXCom tools.

' Development Status:
' Works.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008-2011 Ron Klinkien

' Read file called COPYING for license details.

PUBLIC SUB Form_Open()

  ME.Move(FMain.X + 50, FMain.Y + 70)

  IF Main.hRFXComRX = NULL THEN
    DisableRX()
  ELSE
    chkDebug.Value = Main.hRFXComRX.RFXComDebug
  ENDIF

  IF Main.hRFXComTX = NULL THEN
    DisableTX()
  ELSE
    chkDebugTX.Value = Main.hRFXComTX.RFXComDebug
  ENDIF

  ' fill combo's with values
  FMain.FillCombo(cmbACDevice1, "4")
  FMain.FillCombo(cmbACDevice2, "FF")
  FMain.FillCombo(cmbACDevice3, "FF")
  FMain.FillCombo(cmbACDevice4, "FF")
  FMain.FillCombo(cmbACUnit, "16")
  FMain.FillCombo(cmbARCDevice, "16")

END

PUBLIC SUB btnClose_Click()

  ME.Close

END

PUBLIC SUB btnInject_Click()

  Main.hRFXComRX.bSimulate = TRUE
  IF txtPacketRX.Text THEN Main.hRFXComRX.Simulate(txtPacketRX.Text)

END

PUBLIC SUB btnVersion_Click()

  Main.hRFXComRX.GetVersion()

END

PUBLIC SUB btnEnableAll_Click()

  Main.hRFXComRX.ProtocolSetup("ALL")

END

PUBLIC SUB btnOregon_Click()

  Main.hRFXComRX.ProtocolSetup("OREGON")

END

PUBLIC SUB btnX10_Click()

  Main.hRFXComRX.ProtocolSetup("X10")

END

PUBLIC SUB btnARC_Click()

  Main.hRFXComRX.ProtocolSetup("ARC")

END

PUBLIC SUB btnKoppla_Click()

  Main.hRFXComRX.ProtocolSetup("KOPPLA")

END

PUBLIC SUB btnATI_Click()

  Main.hRFXComRX.ProtocolSetup("ATI")

END

PUBLIC SUB btnVisonic_Click()

  Main.hRFXComRX.ProtocolSetup("VISONIC")

END

PUBLIC SUB btnSomfy_Click()

  Main.hRFXComRX.ProtocolSetup("SOMFY")

END

PUBLIC SUB btnHEUK_Click()

  Main.hRFXComRX.ProtocolSetup("HEUK")

END

PUBLIC SUB btnHEEU_Click()

  Main.hRFXComRX.ProtocolSetup("HEEU")

END

PUBLIC SUB chkDebug_Click()

  Main.hRFXComRX.RFXComDebug = chkDebug.Value

END

PUBLIC SUB DisableRX()

  btnSomfy.Enabled = FALSE
  btnVisonic.Enabled = FALSE
  btnATI.Enabled = FALSE
  btnKoppla.Enabled = FALSE
  btnARC.Enabled = FALSE
  btnX10.Enabled = FALSE
  btnOregon.Enabled = FALSE
  btnHEUK.Enabled = FALSE
  btnHEEU.Enabled = FALSE
  btnVersion.Enabled = FALSE
  btnEnableAll.Enabled = FALSE
  btnInject.Enabled = FALSE
  chkDebug.Enabled = FALSE

END

PUBLIC SUB DisableTX()

  btnVersionTX.Enabled = FALSE
  btnEnableARCTX.Enabled = FALSE
  btnEnableHarrisonTX.Enabled = FALSE
  btnDisableX10TX.Enabled = FALSE
  chkDebugTX.Enabled = FALSE
  btnEnableKopplaTX.Enabled = FALSE
  slDim.Enabled = FALSE

  ' ARC / X10
  btnARCOn.Enabled = FALSE
  btnARCOff.Enabled = FALSE
  btnARCDim.Enabled = FALSE
  btnARCBright.Enabled = FALSE
  btnARCLightsOff.Enabled = FALSE
  btnARCLightsOn.Enabled = FALSE
  cmbARCHouse.Enabled = FALSE
  cmbARCDevice.Enabled = FALSE

  ' AC / HE UK
  cmbACDevice1.Enabled = FALSE
  cmbACDevice2.Enabled = FALSE
  cmbACDevice3.Enabled = FALSE
  cmbACDevice4.Enabled = FALSE
  cmbACUnit.Enabled = FALSE
  btnACOff.Enabled = FALSE
  btnACOn.Enabled = FALSE
  chkHEEU.Enabled = FALSE
  tbtnACGroup.Enabled = FALSE

END

' transmitter code below this line
PUBLIC SUB chkDebugTX_Click()

  Main.hRFXComTX.RFXComDebug = chkDebug.Value

END

PUBLIC SUB btnVersionTX_Click()

  Main.hRFXComTX.GetVersion()

END

PUBLIC SUB btnEnableARCTX_Click()

  Main.hRFXComTX.EnableARCTX()

END

PUBLIC SUB btnEnableHarrisonTX_Click()

  Main.hRFXComTX.EnableHarrisonTX()

END

PUBLIC SUB btnEnableKopplaTX_Click()

  Main.hRFXComTX.EnableKopplaTX()

END

PUBLIC SUB btnDisableX10TX_Click()

  Main.hRFXComTX.DisableX10TX()

END

PUBLIC SUB ControlTX(sAddress AS String, sCmd AS String)

  Main.hRFXComTX.X10(sAddress, sCmd)

END

' ARC
PUBLIC SUB btnARCOn_Click()

  ControlTX(cmbARCHouse.Text & cmbARCDevice.Text, "On")

END

PUBLIC SUB btnARCOff_Click()

  ControlTX(cmbARCHouse.Text & cmbARCDevice.Text, "Off")

END

PUBLIC SUB btnARCDim_Click()

  ControlTX(cmbARCHouse.Text & cmbARCDevice.Text, "Dim")

END

PUBLIC SUB btnARCBright_Click()

  ControlTX(cmbARCHouse.Text & cmbARCDevice.Text, "Bright")

END

PUBLIC SUB btnARCLightsOn_Click()

  ControlTX(cmbARCHouse.Text & cmbARCDevice.Text, "All_Lights_On")

END

PUBLIC SUB btnARCLightsOff_Click()

  ControlTX(cmbARCHouse.Text & cmbARCDevice.Text, "All_Lights_Off")

END

' AC / HEEU
PUBLIC SUB btnACOn_Click()

  Main.hRFXComTX.AC(cmbACDevice1.Index & cmbACDevice2.Text & cmbACDevice3.Text & cmbACDevice4.Text & " " & cmbACUnit.Text, "On", chkHEEU.Value, tbtnACGroup.Value)

END

PUBLIC SUB btnACOff_Click()

  Main.hRFXComTX.AC(cmbACDevice1.Index & cmbACDevice2.Text & cmbACDevice3.Text & cmbACDevice4.Text & " " & cmbACUnit.Text, "Off", chkHEEU.Value, tbtnACGroup.Value)

END

PUBLIC SUB slDim_Change()

  Main.hRFXComTX.AC(cmbACDevice1.Index & cmbACDevice2.Text & cmbACDevice3.Text & cmbACDevice4.Text & " " & cmbACUnit.Text, "Dim " & slDim.Value, chkHEEU.Value, tbtnACGroup.Value)

END
