' Gambas class file

' Description:
' FDebug.class
' page for test programs, variables, buttons etc.

' Development Status:
' Just implemented, needs work.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008 Ron Klinkien

' Read file called LICENSE for license details.

PRIVATE tRefresh AS NEW Timer

PUBLIC SUB Form_Open()

  GetVarList()

  ' create refresh timer
  tRefresh = NEW Timer AS "tRefresh"
  tRefresh.Delay = 10000 ' 10 seconds
  tRefresh.Start

END

PUBLIC SUB GetVarList()

  DIM iRows, iCount AS Integer
  DIM vValue AS Variant

  iRows = Main.GlobalVar.Count

  WITH tbvGlobalVar
    .Columns.Count = 2
    .Rows.Count = iRows
    .Columns[0].Title = ("Name")
    .Columns[0].Width = 120
    .Columns[1].Title = ("Value")
    .Columns[1].Width = 130
  END WITH

  FOR EACH vValue IN Main.GlobalVar
    tbvGlobalVar[iCount, 0].Text = Main.GlobalVar.Key
    IF IsBoolean(vValue) THEN
      tbvGlobalVar[iCount, 1].Text = Main.DisplayBoolean(vValue)
    ELSE 
      tbvGlobalVar[iCount, 1].Text = vValue
    END IF
    iCount = iCount + 1
  NEXT

END

PUBLIC SUB tbvGlobalVar_ColumnClick(Column AS Integer)

  Main.SortTableView(FDebug.tbvGlobalVar, Column, TRUE)

END

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' voicetext test buttons
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
PUBLIC SUB btnSpeakMale_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"), "male")

END

PUBLIC SUB btnSpeakFemale_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"), "female")

END

PUBLIC SUB btnSpeakDefault_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"))

END

PUBLIC SUB btnSpeakAllison_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"), "allison")

END

PUBLIC SUB btnSpeakLinda_Click()

  VoiceText.Speak(Main.Random_Text("remarks_plants"), "linda")

END

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' refresh page contents
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
PUBLIC SUB tRefresh_Timer()

  GetVarList()

END

PUBLIC SUB Form_Close()

  tRefresh.Start

END

PUBLIC SUB btnSoundPlay_Click()

  Sounds.PlaySnd("click.wav")

END

PUBLIC SUB btnSoundPlay50_Click()

  Sounds.PlaySnd("click.wav", 50)

END

PUBLIC SUB btnWOL_Click()

  Main.WakeOnLan("00:19:bb:d4:ad:41")

END

PUBLIC SUB btnFanSpd1_Click()

  Devices.SetDevice("House Ventilation", "1")

END

PUBLIC SUB btnFanSpd2_Click()

  Devices.SetDevice("House Ventilation", "2")

END

PUBLIC SUB btnFanSpd3_Click()

  Devices.SetDevice("House Ventilation", "3")

END

PUBLIC SUB btnFanTimer_Click()

  Devices.SetDevice("House Ventilation", "T")

END
