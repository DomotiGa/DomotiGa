' Gambas class file

' Description:
' FToolsRFXComSimulate.class
' Allows injection of a packet to test RFXCom module parser.

' Development Status:
' Works.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008 Ron Klinkien

' Read file called COPYING for license details.

PUBLIC SUB Form_Open()

  ME.Move(FMain.X + 50, FMain.Y + 70)

  IF NOT Main.bRFXComEnabled THEN
    Message.Info("RFXCom module is not enabled.")
    FToolsRFXComSimulate.Close
  ELSE
    chkDebug.Value = Main.hRFXCom.RFXComDebug
  END IF

END

PUBLIC SUB btnClose_Click()

  ME.Close

END

PUBLIC SUB btnInject_Click()

  Main.hRFXCom.bSimulate = TRUE
  IF txtPacket.Text THEN Main.hRFXCom.Simulate(txtPacket.Text)

END

PUBLIC SUB btnVersion_Click()

  Main.hRFXCom.GetVersion()

END

PUBLIC SUB btnEnableAll_Click()

  Main.hRFXCom.DisableProtocol("ALL")

END

PUBLIC SUB btnOregon_Click()

  Main.hRFXCom.DisableProtocol("OREGON")

END


PUBLIC SUB btnX10_Click()

  Main.hRFXCom.DisableProtocol("X10")

END

PUBLIC SUB btnARC_Click()

  Main.hRFXCom.DisableProtocol("ARC")

END

PUBLIC SUB btnKoppla_Click()

  Main.hRFXCom.DisableProtocol("KOPPLA")

END

PUBLIC SUB btnATI_Click()

  Main.hRFXCom.DisableProtocol("ATI")

END

PUBLIC SUB btnVisonic_Click()

  Main.hRFXCom.DisableProtocol("VISONIC")

END

PUBLIC SUB btnSomfy_Click()

  Main.hRFXCom.DisableProtocol("SOMFY")

END

PUBLIC SUB btnHE_Click()

  Main.hRFXCom.DisableProtocol("HE")

END

PUBLIC SUB chkDebug_Click()

  Main.hRFXCom.RFXComDebug = chkDebug.Value

END
