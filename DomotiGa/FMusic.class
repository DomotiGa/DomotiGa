' Gambas class file

' Description:
' FMusic.class
' Room for audio player controls.

' Development Status:
' Working.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008-2010 Ron Klinkien

' Read file called COPYING for license details.

PUBLIC SUB Form_Open()

  IF Main.bOnkyoEnabled THEN
    pnlOnkyo.Enabled = TRUE
  ELSE
    pnlOnkyo.Enabled = FALSE
  ENDIF
  IF Main.bDenonEnabled THEN
    pnlDenon.Enabled = TRUE
  ELSE
    pnlDenon.Enabled = FALSE
  ENDIF
  IF Main.bSqueezeServerEnabled THEN
    pnlSqueeze.Enabled = TRUE
  ELSE
    pnlSqueeze.Enabled = FALSE
  ENDIF
  pnlDenon.Hide
  pnlOnkyo.Hide
  pnlSqueeze.Hide

END

PUBLIC SUB Form_Resize()

  pnlSqueeze.Move(4, 30, ME.ClientWidth - 10, ME.ClientHeight - 31)
  pnlDenon.Move(4, 30, ME.ClientWidth - 10, ME.ClientHeight - 31)
  pnlOnkyo.Move(4, 30, ME.ClientWidth - 10, ME.ClientHeight - 31)
  HBox1.Width = ME.ClientWidth - 15

END

PUBLIC SUB btnOnkyo_Click()

  btnOnkyo.Enabled = FALSE
  btnDenon.Enabled = TRUE
  btnSqueeze.Enabled = TRUE
  pnlOnkyo.Show
  pnlDenon.Hide
  pnlSqueeze.Hide

END

PUBLIC SUB btnDenon_Click()

  btnDenon.Enabled = FALSE
  btnOnkyo.Enabled = TRUE
  btnSqueeze.Enabled = TRUE
  pnlDenon.Show
  pnlOnkyo.Hide
  pnlSqueeze.Hide

END

PUBLIC SUB btnSqueeze_Click()

  btnSqueeze.Enabled = FALSE
  btnDenon.Enabled = TRUE
  btnOnkyo.Enabled = TRUE
  pnlSqueeze.Show
  pnlDenon.Hide
  pnlOnkyo.Hide

END

PUBLIC SUB slOnkyoVolume_Change()

  ControlOnkyo("volume", slOnkyoVolume.Value)
  lcdOnkyoVolume.Value = slOnkyoVolume.Value

END

PUBLIC SUB btnOnkyoMute_Click()

  IF btnOnkyoMute.Value = TRUE THEN
    ControlOnkyo("mute", "on")
  ELSE
    ControlOnkyo("mute", "off")
  ENDIF

END

PRIVATE SUB ControlOnkyo(sCmd AS String, sValue AS String)

  IF Main.bStandalone THEN
    Main.hOnkyo.SetCommand(sCmd, sValue, 1)
  ELSE
    XMLClient.AVSetControl("onkyo", sCmd, sValue, 1)
  END IF

END

PRIVATE SUB ControlDenon(sCmd AS String, sValue AS String)

  IF Main.bStandalone THEN
    Main.hDenon.SetCommand(sCmd, sValue, 1)
  ELSE
    XMLClient.AVSetControl("denon", sCmd, sValue, 1)
  END IF

END

PUBLIC SUB InputSelectOnkyo_Click()

  ControlOnkyo("input", LAST.Tag)

END

PUBLIC SUB tbtnOnkyoPower_Click()

  IF tbtnOnkyoPower.Value THEN
    tbtnOnkyoPower.Text = "On"
    ControlOnkyo("power", "on")
  ELSE
    tbtnOnkyoPower.Text = "Standby"
    ControlOnkyo("power", "off")
  ENDIF

END

PUBLIC SUB tbtnDenonPower_Click()

  IF tbtnDenonPower.Value THEN
    tbtnDenonPower.Text = "On"
    ControlDenon("power", "on")
  ELSE
    tbtnDenonPower.Text = "Standby"
    ControlDenon("power", "off")
  ENDIF

END

PUBLIC SUB slDenonVolume_Change()

  ControlDenon("volume", slDenonVolume.Value)
  lcdDenonVolume.Value = slDenonVolume.Value

END

PUBLIC SUB btnDenonMute_Click()

  IF btnDenonMute.Value = TRUE THEN
    ControlDenon("mute", "on")
  ELSE
    ControlDenon("mute", "off")
  ENDIF

END