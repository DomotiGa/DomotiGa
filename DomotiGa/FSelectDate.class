' Gambas class file

' Description:
' FSelectDate.class
' Provides datechooser for birthday and other fields.

' Development Status:
' Working.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008 Ron Klinkien

' Read file called LICENSE for license details.

PUBLIC $sDate AS String

PUBLIC SUB Run(OPTIONAL sDate AS String) AS String

  $sDate = sDate
  IF NOT ME.ShowModal() THEN RETURN
  RETURN $sDate

END

PUBLIC SUB Form_Open()

  IF $sDate THEN
    dchDate.Year = Year($sDate)
    dchDate.Month = Month($sDate)
    dchDate.Day = Day($sDate)
  ENDIF

END

PUBLIC SUB btnCancel_Click()

  ME.Close

END

PUBLIC SUB btnOK_Click()

  ' return selected date
  $sDate = dchDate.Month & "/" & dchDate.Day & "/" & dchDate.Year
  ME.Close(TRUE)

END
