' Gambas class file

' Description:
' FSettingsMySQL.class
' Settings form for database connection.

' Development Status:
' Works.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008 Ron Klinkien

' Read file called LICENSE for license details.

PUBLIC SUB Form_Open()

  ME.Move(FMain.X + 50, FMain.Y + 70)

  WITH Main
    txtDBHost.Text = .sSQLHost
    txtUser.Text = .sSQLUser
    txtPassword.Text = .sSQLPass
    txtDatabase.Text = .sSQLDatabase
    chkDebug.Value = .bSQLDebug
  END WITH
  btnSave.Enabled = FALSE

END

PUBLIC SUB btnSave_Click()

  WITH Main
    .sSQLHost = txtDBHost.Text
    .sSQLUser = txtUser.Text
    .sSQLPass = txtPassword.Text
    .sSQLDatabase = txtDatabase.Text
    .bSQLDebug = chkDebug.Value
  END WITH

  ' reconnect with new settings
  Main.SetConfig()
  Main.GetConfig()
  Main.ConnectDatabase()
  ME.Close

END

PUBLIC SUB btnCancel_Click()

  ME.Close

END

PUBLIC SUB txtDBHost_KeyPress()

  btnSave.Enabled = TRUE

END

PUBLIC SUB textDBHost_KeyPress()

  btnSave.Enabled = TRUE

END

PUBLIC SUB txtDatabase_KeyPress()

  btnSave.Enabled = TRUE

END

PUBLIC SUB txtUser_KeyPress()

  btnSave.Enabled = TRUE

END

PUBLIC SUB txtPassword_KeyPress()

  btnSave.Enabled = TRUE

END

PUBLIC SUB chkDebug_Click()

  btnSave.Enabled = TRUE

END
