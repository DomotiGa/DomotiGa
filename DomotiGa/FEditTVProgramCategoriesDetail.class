' Gambas class file

' Description:
' FEditTVProgramCategoriesDetail.class
' Form for editing TV category details.

' Development Status:
' Imported from Kris's own project, needs testing.

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' This module is written by Kris Wauters on February, 16th - 2010
' For more info or help, mailto: kris@digitalplayground.be

' Read file called COPYING for license details.

PRIVATE BoolStart AS Boolean = TRUE

PUBLIC SUB Form_Open()

  IF BoolStart = TRUE THEN
    BtnPreview.BackColor = TxtBackColor.BackColor
    BtnPreview.ForeColor = TxtForeColor.BackColor
    BoolStart = FALSE
  END IF

END

PUBLIC SUB BtnCancel_Click()

  ME.Close

END

PUBLIC SUB BtnOK_Click()

  '--- declare variables ---
  DIM IntRecID AS Integer
  DIM PicBLOBpreview AS PictureBox

  TxtEXTPreview.Text = "PNG"
  IntRecID = ScreenFunc.ActionOnDetailScreen(ME)
  IF IntRecID > 0 THEN
    PicBLOBpreview = NEW PictureBox(ME)
    PicBLOBpreview.Name = "PicBLOBpreview"
    PicBLOBpreview.Border = Border.None
    PicBLOBpreview.Width = BtnPreview.Width
    PicBLOBpreview.Height = BtnPreview.Height
    PicBLOBpreview.Picture = BtnPreview.Grab()
    PicBLOBpreview.Tag = "BLOB|EXTpreview"
    ScreenFunc.BlobOnDetailScreen(IntRecID, ME.tag, PicBLOBpreview)
  END IF
  ME.Close

END

PUBLIC SUB BtnForeColor_Click()

  WITH Dialog
    .Color = TxtForeColor.BackColor
    .Title = ("Please select a foreground color ...")
  END WITH
  IF Dialog.SelectColor() THEN
    RETURN
  ELSE
    TxtForeColor.BackColor = Dialog.Color
    BtnPreview.ForeColor = Dialog.Color
  END IF

END

PUBLIC SUB BtnBackColor_Click()

  WITH Dialog
    .Color = TxtBackColor.BackColor
    .Title = ("Please select a background color ...")
  END WITH
  IF Dialog.SelectColor() THEN
    RETURN
  ELSE
    TxtBackColor.BackColor = Dialog.Color
    BtnPreview.BackColor = Dialog.Color
  ENDIF

END
