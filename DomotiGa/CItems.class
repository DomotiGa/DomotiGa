' Gambas class file

' Description:
' Items.class
' Support for XML items (FNews.class)

' DomotiGa - an open source home automation program.
' Copyright (C) Ron Klinkien, The Netherlands.

' Read file called COPYING for license details.

last_checked AS Date
titles AS NEW String[255]
descriptions AS NEW String[255]
links AS NEW String[255]
last_index AS Integer
current_index AS Integer

PUBLIC SUB Main()

  current_index = 0
  last_index = 0
  last_checked = Now

END

PUBLIC SUB addItem(title AS String, description AS String, item_link AS String)

  INC last_index
  titles[last_index] = title
  descriptions[last_index] = description
  links[last_index] = item_link

END

PUBLIC SUB reset()

  current_index = 0

END

PUBLIC SUB clear()

  current_index = 0
  last_index = 0
  titles = NEW String[255]
  links = NEW String[255]
  descriptions = NEW String[255]

END

PUBLIC FUNCTION next() AS Boolean

  IF last_index = current_index THEN
    RETURN FALSE
  ELSE
    INC current_index
    RETURN TRUE
  END IF

END

PUBLIC FUNCTION getTitle() AS String

  RETURN titles[current_index]

END

PUBLIC FUNCTION getDescription() AS String

  RETURN descriptions[current_index]

END

PUBLIC FUNCTION getLink() AS String

  RETURN links[current_index]

END

PUBLIC FUNCTION getCurrentIndex() AS Integer

  RETURN current_index

END

PUBLIC FUNCTION seek(index AS Integer) AS Boolean

  IF index <= last_index AND index >= 0 THEN
    current_index = index
    RETURN TRUE
  ELSE
    RETURN FALSE
  ENDIF

END
