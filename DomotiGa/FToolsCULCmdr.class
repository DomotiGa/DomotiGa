' Gambas class file

' Description:
' FToolsCULCmdr.class
' Allows injection of a packet to test CUL module parser.

' Development Status:
' Works.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008-2011 Ron Klinkien

' Read file called COPYING for license details.

PUBLIC SUB Form_Open()

  ME.Move(FMain.X + 50, FMain.Y + 70)
  chkDebug.Value = Main.bCULDebug
  chkDebug2.Value = Main.bCULDebug
  IF NOT Main.bCULEnabled THEN Main.Setup_DummyCUL()

END

PUBLIC SUB btnClose_Click()

  ME.Close

END

PUBLIC SUB btnInject_Click()

  IF txtPacketRX.Text THEN Simulate(txtPacketRX.Text)

END

PUBLIC SUB btnSend_Click()

  IF txtCommand.Text THEN QueueCommand(txtCommand.Text)

END

PUBLIC SUB btnVersion_Click()

  QueueCommand("V")

END

PRIVATE SUB QueueCommand(sCmd AS String)

  IF Main.bServer AND IF Main.hCUL THEN
    Main.hCUL.QueueCommand(sCmd)
  ELSE
    XMLClient.CULQueueCommand(sCmd)
  ENDIF

END

PRIVATE SUB Simulate(sPacket AS String)

  IF Main.bServer AND IF Main.hCUL THEN
    Main.hCUL.Simulate(sPacket)
  ELSE
    XMLClient.CULSimulate(sPacket)
  ENDIF

END