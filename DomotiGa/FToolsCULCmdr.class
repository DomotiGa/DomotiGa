' Gambas class file

' Description:
' FToolsCULCmdr.class
' Allows injection of a packet to test CUL module parser.

' Development Status:
' Works.

' DomotiGa - an open source home automation program.
' Copyright(C) 2008-2011 Ron Klinkien

' Read file called COPYING for license details.

PUBLIC SUB Form_Open()

  ME.Move(FMain.X + 50, FMain.Y + 70)

  IF NOT Main.bCULEnabled THEN
    Main.Setup_DummyCUL()
  ELSE
    chkDebug.Value = Main.bCULDebug
  END IF

END

PUBLIC SUB btnClose_Click()

  ME.Close

END

PUBLIC SUB btnInject_Click()

  IF Main.hCUL THEN
    Main.hCUL.bSimulate = TRUE
    IF txtPacketRX.Text THEN Main.hCUL.Simulate(txtPacketRX.Text)
  END IF

END

PUBLIC SUB btnSend_Click()

  IF Main.hCUL THEN 
    IF txtCommand.Text THEN Main.hCUL.QueueCommand(txtCommand.Text)
  ENDIF

END

PUBLIC SUB btnVersion_Click()

  Main.hCUL.QueueCommand("V")

END
